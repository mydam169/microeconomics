---
title: "Chapter 7. Externalities and public goods"
author:
    name: My Dam
    email: my-thi-tra.dam@universite-paris-saclay.fr
number-sections: true
execute:
    echo: false
format:
    html:
        toc: true
        toc-depth: 3
        toc-title: "Content"
        # toc-expand: true
        toc-location: "left"
        # embed-resources: true
---


```{python}
%load_ext autoreload
%autoreload 2
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm
import seaborn as sns
import pandas as pd
import dataframe_image as dfi
import ipywidgets as widgets
from IPython.display import display
from ipywidgets import interact
import pandas as pd
```

```{python}
import sys
import os
mod_dir = os.path.join(os.getcwd(), 'modules')
if mod_dir not in sys.path:
    sys.path.append(mod_dir)

import micro_modules as mm
mm.load_viz_settings()
```

Just like market power, externalities and public goods are two other causes of market failures. In presence of externalities or public goods, the competitive market fails to produce an efficient outcome. In this chapter, we will be analyzing these problems and their common solutions. 

# Externalities

## Definition and examples

An externality is the effect that agent has on the welfare of another agent beyond the effects transmitted by changes in prices.
It typically represents an effect imposed on or benefited by a third party to an exchange/transaction.

::: {#tbl-ext-exm tbl-cap="Externalities: types and examples"}
<table style="text-align:left; width=100%">
    <tr>
        <th></th>
        <th>Negative</th>
        <th>Positive</th>
    </tr>
    <tr>
        <th align=left>From consumption</th>
        <td>
            <ul>
                <li>Passive smoking</li>
                <li>Noisy neighbors</li>
            </ul>
        </td>
        <td>
            <ul>
                <li>Vaccination</li>
                <li>Education</li>
            </ul>
        </td>
    </tr>
    <tr>
        <th>From production</th>
        <td>
            <ul>
                <li>Air pollution by coal-powered power stations</li>
                <li>Water contamination by a firm that dumps industrial wastes directly into the river</li>
            </ul>
        </td>
        <td>
            <ul>
                <li>Unpatented research and development</li>
                <li>Apiculture</li>
            </ul>
        </td>
    </tr>
</table>
:::

## Modeling externalities

Consider a economy with two types of agents: a firm and a consumer. The firm's productive activities generate negative externalities that affect the consumer.

### The representative firm

The firm's objective is to maximize profit $\pi(x,p)$ where $p$ is the price vector and $x$ the amount of externality generated. In a competitive market the firm is a price taker, taking $p$ as given, allowing us to write the profit function s $\pi(x).$ We assume that the profit functionis twice differentiable, increasing and concave:

$$
\pi'(x) > 0 > \pi''(x).
$${#eq-assumption-profit}

In words, we assume that profits increase with externalities since the firm does not bear the full marginal cost of production. Nevertheless, the marginal benefits of pollution decline. Note that since externalities are generated by production, making decision on externalities can be considered equivalent to making decision on output, as illustrated in @exm-eqm-ext.

### The reprsentative consumer

The consumer has preferences reprsented by an utility function $u(q,x),$ where $q\in\mathbb{R}_+^n$ is the consumption bundle, the vector of _tradable goods_, and $x$ is the negative externatlity, which is _not tradable_ (otherwise it would have had a price and the impact would have been internalized!). We assume:

$$
u_k \equiv \frac{\partial u}{\partial q_k} \geq 0,\quad \forall k=1,\dots,n.
$${#eq-assume-u-q}

and

$$
u_x \equiv \frac{\partial u}{\partial x} \lt 0.
$${#eq-assum-u-x}

Denote $w$ the consumer's income and $q^*(p,w,x)$ the Walrasian demand function. Then the indirect utility function (the maximized utility function) is:

$$
    v(x) = u(q*(p,w,x),x).
$${#eq-indirect-u}

Observe that $v'(x)<0$ for all $x>0.$

### Competitive and pareto equilibrium externality

In a competitive equilibrium, the firm selects the (private) level of externatlity that maximizes its profits:

$$
x^P = \arg\max_{x\geq 0} \pi(x),
$${#eq-firm-CE}

The FOC of which yields (for an interior solution):

$$
\pi'(x^P) = 0,.
$${#eq-foc-CE}


In a Pareto equilibrium, the social planner selects the level of externality that maximizes the sum of profits and utilities:

$$
x^E = \arg\max_{x\geq 0} \pi(x) + v(x).
$${#eq-SP}

The necessary condition for an iterior solution is:

$$
\pi'(x^E) = - v'(x^E).
$${#eq-FOC-SP}

In other words, the social planner selects a level of externality such that the marginal benefit derived from it by the firm is equal to the marignal cost (disutility) suffered by the consumer.

Since $v'(x)<0,$ and $\pi''(x)<0,$ we have:

$$
\begin{aligned}
\pi'(x^E) > 0 &= \pi'(x^P) \\
x^E &< x^P.
\end{aligned}
$$

Hence the Pareto efficient level of pollution, $x^E$ is less than the competitve level $x^P$ selected by the firm. 

::: {#exm-eqm-ext}
Consider a firm with $\pi = pq - cq^2$ where $q$ is the output, $p$ is the price of the good and $c>0$ is a constant. Suppose that externality is a linear function of quantity, namely $x=a q,$ with $a >0.$ Hence:

$$
\pi(x) = p\frac{x}{a} - c\left(\frac{x}{a}\right)^2.
$$

The FOC yields:
$$
x^P = \frac{ap}{2c}.
$$

Suppose that the consumer has a damange function defined by:

$$
v(x) = b - cx - \frac{dx^2}{2},\quad b,d>0.
$$
Observe that the marginal cost of the damage increases in the level of pollution. This makes sense intuitively if we think about how health deterioration accelerates as pollution gets worse.

In view of @eq-FOC-SP, we can determine the Pareto efficient level of externality:

$$
\begin{aligned}
\pi'(x^E) &= -v'(x^E) \\
\frac{p}{a}-\frac{2c}{a^2}x^E &= c+dx^E \\
x^E &= \frac{ap-a^2c}{2c+ad}.
\end{aligned}
$$

When is it efficient to have a positive amount of externality, i.e., to have $x^E>0?$ Observe that $v'(0)=-c$ and $\pi'(0)=p/a$ and $x^E > 0$ if and only if $pa-ca^2 >0,$ which is equivalent to $p/a > c$ or $\pi'(0)>-v'(0).$ In other words, the economy should generate negative externalities if the marginal benefits of doing so for firms are greater than the marginal costs to consumers at the origin.
::: 

::: {#exm-positive-ext}
## Positive externalities
Consider two neighboring countries, $i$ and $j,$ simultaneously choosing the level of investment in recycling activities $x_i.$ The benefit from recycling is given by:

$$
\pi_i(x_i,x_j) = (a - 0.5x_i + 0.25x_j)x_i - bx_i,
$$

where $a,b>0.$

In a competitive equilibrium, country $i$ chooses $x_i$ so as to maximize its own benefit. The optimal conditions provide the best response functions for the firms. In particular:
$$
\begin{aligned}
\frac{\partial{\pi_i}}{\partial x_i} = 0
\iff x_i &= a - b + \frac{x_j}{4} \\
BR_i(x_j) &= a - b + \frac{x_j}{4},
\end{aligned}
$$

and likewise for country $j.$

The NE of this game is:
$$
x_i^* = x_j^* = \frac{4(a - b)}{3}.
$${#eq-NE-comp}

To be Pareto optimal, each country considers not only its own benefit but also that of the other country when making a decision. Another way to think about this is to make a decision from the point of view of a social planner who determines both investment levels to maximize joint benefits:

$$
\max_{x_i,x_j} \pi(x_i,x_j) \equiv \pi_i(x_i,x_j) + \pi_j(x_i,x_j).
$${#eq-pos-ext-SP}

The FOC condition for country $i$ gives:

$$
\begin{aligned}
\frac{\partial \pi}{\partial x_i} &= 0 \\
\frac{\partial \pi_i(x_i,x_j)}{\partial x_i} + \frac{\partial \pi_j(x_i,x_j)}{\partial x_i} &= 0 \\
x_i &= a - b + \frac{x_j}{2}.
\end{aligned}
$$

Likewise for country $j:$ 

$$
x_j = a - b \frac{x_i}{2}.
$$

Hence the best response lines are steeper compared to the competitive case, resulting in higher equilibrium investments. In particular, the socially efficient NE is:

$$
x_i^E = x_j^E = 2(a-b).
$$

:::

# Public goods


# Exercises
