{"title":"Chapter 3. Equlibrium","markdown":{"yaml":{"title":"Chapter 3. Equlibrium","number-sections":true,"execute":{"echo":false},"format":{"html":{"toc":true,"toc-depth":3,"toc-title":"Content","toc-location":"left"}}},"headingText":"Perfectly competitive markets","containsRefs":false,"markdown":"\n\n\n```{python}\n%load_ext autoreload\n%autoreload 2\n```\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport seaborn as sns\nimport pandas as pd\nimport dataframe_image as dfi\nimport ipywidgets as widgets\nfrom IPython.display import display\nfrom ipywidgets import interact\nimport pandas as pd\n```\n\n```{python}\nimport sys\nimport os\nmod_dir = os.path.join(os.getcwd(), 'modules')\nif mod_dir not in sys.path:\n    sys.path.append(mod_dir)\n\nimport micro_modules as mm\nmm.load_viz_settings()\n```\n\n```{python}\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n```\n\nIn this chapter we will be examining market equilibria. We shall begin by deriving the market supply curve, which results from firms' optimal production decision. Likewise, market demand results from consumers' optimal consumption decision. Searching for an equilibrium is essentially searching for prices that equalize demand and supply in the market. When a single market is considered in isolation, its equilibrium is a partial one. When all markets are considered, we speak of a general equilibrium. In a pure exchange economy, all markets are markets of consumption goods. In  a production economy, the relevant markets include those of factors of production such as labor, capital and land. In this course, we will be mostly interested in general equilibria in a pure exchange economy. \n\n\nOur markets in this chapter are perfectly competitive, their features are:\n\n* Fragmentation: large number of producers and consumers whose decisions (to produce or consume) do not influence market prices of the goods. In other words, all market participants are price-takers\n\n* Undifferentiated products: products of all firms in the same industry are regarded as identical by consumers\n\n* Perfect information: information on prices are transparent and freely accessible by consumers\n\n* Free entry and exit: in the long run (LR), firms can freely enter and exit \n\nExample: Wheat, corn, or agricultural commodities\n\n# Firm's profit maxmimization problem (PMP)\n\n## The PMP\n\n<!-- * Is the dual problem of the cost minimization problem (CMP) introduced previously\n    * In that problem, we implicitly assumed that firms were price-takers in the markets of inputs -->\n\n::: {#def-PMP}\n## Firm's PMP\nConsider a price-taking firm in the market of the output good\nGiven $p$, the market price of the good, every firm's PMP is:\n$$\n\\max_{q\\geq 0} \\pi = R(q) - C(q) = pq - C(q), \n$$\nwhere $C(q)$ is the total cost function derived from the CMP introduced previously, $R(q)$ denotes the total revenue. \n:::\n    \nObserve that the PMP includes the CMP as a first step\n\n## Necessary conditions\n\nAccording to the KT conditions, either \n\n* we have a corner solution $q=0$, or\n\n* We have an interior solution $q>0$ satisfying the FOC:\n\n    $$\n        \\pi'(q) = 0 \\iff p = C'(q) \\\\\n        \\iff p = MC(q).\n    $$\n    \n* Observe that for a price-taking firm, the marginal revenue is the market price of the good (as we shall see later, for a firm with market power, the marginal revenue is _less_ than the price)\n\n* The FOC above implies that the firm produces up to a point where the marginal revenue (marginal benefit) is equal to the marginal cost. \n    \n## Sufficient condition\n\n* The FOC is sufficient for a max if the profit function is concave  in output. This is called the second-order condition (SOC)\n\n* We have:\n\n    $$ \n    \\pi''(q) = -C''(q), \n    $$\n    \n    implying that the SOC is satisfied if the cost function is convex in $q$ (i.e., if the MC is increasing in output)\n\n\n    \n## Examples\n\n::: {#exm-ESCex}\nLet us solve the PMP of a price-taking firm in the output market (and inputs market). Assume that it has a Cobb-Douglas production function defined by $q(L, K) = L^{1/2}K^{1/2}$. The factor prices are $w=\\$40$ and $r=\\$10$ as before.\n\n* Step 1: Solve the CMP:\n\n    $$\n    \\begin{aligned}\n    &\\min_{K,L} 40L + 10K \\\\\n    \\text{s.t. } &q(L, K) = L^{1/2}K^{1/2} \\geq q, \n    \\end{aligned}\n    $$\n    \n    for some target output level $q$. \n    \n    * The cost function can be obtained by replacing the solutions of the CMP into the objective function. This yields: \n    \n    $$\n    C(q) = 40q. \n    $$\n\n\n* Step 2: Substitute $C(q)$ obtained from the CMP into the PMP so that this problem reads:\n\n    $$\n    \\max_{q\\geq0} \\pi(q) = pq - 40q = (p - 40)q. \n    $$\n    \n    * Clearly if $p<40$ the firm should shut down\n    \n    * If $p\\geq 40$, the firm produces as much as possible since the profit is then incresing in output\n    \n    * We thus obtain a perfectly elastic individual supply curve\n\n    * Note that this is the long-run individual supply curve since all inputs are variable. One can also verify that the long-run cost function does not have a fixed cost. \n\n::: {#fig-PEScurve fig-cap=\"A perfectly elastic long-run supply curve\"}\n```{python}\nq = np.linspace(0, 5, 100)\np = np.ones(len(q)) * 40\nplt.plot(q, p, lw=2)\nplt.vlines(x=0, ymin=0, ymax=40, lw=2)\nplt.xlabel('Quantity ($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.ylim([0, 60])\nplt.xticks([0])\nplt.yticks([40])\nplt.grid(False)\nplt.show()\n```\n:::\n:::\n\n::: {#exm-linearSC}\nSuppose we have obtained a convex cost function for the firm of the form:\n$$\nC(q) = 0.5 a q^2 + bq + c, \n$$\nwhere $a$, $b$ and $c$ are strictly positive constants. Observe that this is a short-run cost function since fixed costs ($c$) are present. \nThe profit maximizing condition for the firm is:\n$$\nC'(q) = a q + b = p \\iff q = \\frac{p - b}{a}. \n$${#eq-optimal-SR-supply}\n\nTo determine the short-run supply curve of the firm, we need to understand the nature of the fixed costs represented by $c.$ In the short-run, firms are typically do not try to make positive profits, i.e., they do not need to sell each unit for at least their average total cost. Firms only need to recuperate the non-sunk part of the fixed cost. __Sunk__ costs are fixed costs that cannot be recovered by the firm and thus should not affect its decision on future output. For example, advertising costs once spent cannot be recovered. Lease payments, on the other hand, are __non-sunk__ fixed costs can be recovered by sublease if the firm eventually decides to shut down.\n\nFor simplicity, suppose that $c$ is non-sunk. The average total cost in this case is equal to the average non-sunk total cost (ANSC).The firm produces so long as the market price is above the ANSC:\n$$\n\\begin{aligned}\n\\pi(q^*) > 0 &\\iff p > \\frac{C(q^*)}{q^*} \\\\\n&\\iff p > 0.5 a q^* + b + \\frac{c}{q^*} \\\\\n&\\iff p > 0.5 a \\frac{p - b}{a} + b + \\frac{ca}{p - b} \\\\\n&\\iff (p - b)^2 > 2ca \\\\\n&\\iff p > b + \\sqrt{2ca}.\n\\end{aligned}\n$${#eq-positive-prof-cond}\n\nObserve that the last line follows from the fact that $q^* > 0$ if and only if $p > b$ in view of @eq-optimal-SR-supply. This condition tells us that in the SR, the firm suffers from a fixed cost ($c$), which might prevent it from earning positive profits even if it is operating optimally. Note that $p > b + \\sqrt{2ca}$ is equivalent to $q > \\sqrt{2c/a}.$\n\n\n::: {#fig-profFunc fig-cap=\"Profit as a function of market price\"}\n```{python}\na, b, c = 1, 1, 2\ndef costFunc(q):\n    return 0.5 * a * q**2 + b * q + c\ndef profFunc(q, p):\n    return q * p - costFunc(q)\ndef optQ(p):\n    return (p - b) / a\nq = np.linspace(0, 5, 100)\npricelabs = ['low price', 'break-even price', 'high price']\n# plt.plot(q, costFunc(q))\nfor p in range(3):\n    plt.plot(q, profFunc(q, p+2), label=pricelabs[p])\n    plt.ylim([-7, 5])\n    plt.xlim([0, 5])\n    plt.xlabel('Quantity ($q$)', loc='right')\n    plt.ylabel('Profit ($\\pi$)', loc='top')\n    plt.legend(loc='lower left')\n    plt.hlines(y=0, xmin=0, xmax=5, linestyle='--', color='gray')\n    plt.grid(None)\n    plt.yticks([0])\n    plt.xticks([0])\n```\n:::\n\n::: {#fig-linearSC fig-cap=\"A SR upward sloping supply curve $q = \\frac{p - b}{a}$ for $p > b + \\sqrt{2ac}$\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\nq = np.linspace(q_min, 5, 100)\np_min = b + np.sqrt(2 * a * c)\np = a * q + b \nplt.plot(q, p, lw=2)\nplt.vlines(x=0, ymin=0, ymax=p_min, lw=2)\nplt.vlines(x=q_min, ymin=0, ymax=p_min, linestyle='dotted', color='gray')\nplt.hlines(y=p_min, xmin=0, xmax=q_min, linestyles='dotted', color='gray')\nplt.ylim([0.5, 6])\nplt.xlim([-0.04, 4])\nplt.text(-1, 0.95 * p_min, '$b + \\sqrt{2ac}$')\nplt.text(q_min * 0.8, 0.15, r\"$\\sqrt{2c/a}$\")\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.xticks([0])\nplt.yticks([])\nplt.grid(None)\nplt.tight_layout\nplt.show()\n```\n:::\n:::\n\n## Long-run vs short-run firm's supply\n\nThe profit maximizing condition for a competitive firm is that its marginal cost is equal to the market price. This is common for the firm both in the long run and in the short run. The difference lies in the shutdown condition. \n\nIn the short run, firms shutdown if the price cannot cover the average non-sunk costs (ANSC), implying that supply will be:\n\n* zero for all levels of output for which the marginal cost (which is equal to the market price under profit maximizing) is _below_ the ANSC curve, and\n* the part of the marginal cost that is _above_ the ANSC (when output is positive) \n\n\n::: {#fig-SRSC fig-cap=\"SR supply curve\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\np_min = b + np.sqrt(2 * a * c)\nq = np.linspace(0.1, 5, 100)\ndef LRAC(q):\n    return (costFunc(q) - c) / q \ndef ANSC(q):\n    return (costFunc(q) - c / 2) / q \ndef SRAC(q):\n    return costFunc(q) / q \ndef MC(q):\n    return a * q + b\n\nANSC_min = q[np.argmin(ANSC(q))]\nSRAC_min = q[np.argmin(SRAC(q))]\n\nplt.plot(q, MC(q), label='MC', color='gray')\nplt.plot(q, ANSC(q), label='ANSC')\nplt.plot(q, SRAC(q), label='SRAC')\n# plt.plot(q, LRAC(q), label='AVC or LRAC')\nplt.vlines(x=0.1, ymin=0, ymax=ANSC(q).min(), lw=3, color='k')\n\nqnew = np.linspace(ANSC_min, 4, 100)\nplt.plot(qnew, MC(qnew), color='k', lw=3, label='SR Supply')\nplt.ylim([1, 5])\nplt.xlim([-0.1, 4])\nplt.xticks([0])\nplt.yticks([])\nplt.legend(loc='best')\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.grid(None)\n```\n:::\n\nIn the long run, all costs are variable. The average cost (AC) is just the average variable cost (AVC). The firm produces so long as the market price can cover the AVC (or the AC), hence the LR supply curve will be:\n\n* zero for all levels of output for which the marginal cost (which is equal to the market price under profit maximizing) is _below_ the AC (or AVC) curve, and\n* the part of the marginal cost that is _above_ the AC (or AVC) \n\nNote that the SR firms might suffer from losses due to non-sunk fixed costs, but so long as the price can cover the ANSC, it is optimal for them to produce. In the LR, however, the firm produces so long as it earns positive profits and shuts down otherwise.\n\n::: {#fig-LRSC fig-cap=\"LR supply curve\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\np_min = b + np.sqrt(2 * a * c)\nq = np.linspace(0.1, 5, 100)\ndef LRAC(q):\n    return (costFunc(q) - c) / q \ndef ANSC(q):\n    return (costFunc(q) - c / 2) / q \ndef SRAC(q):\n    return costFunc(q) / q \ndef MC(q):\n    return a * q + b\n\nANSC_min = q[np.argmin(ANSC(q))]\nSRAC_min = q[np.argmin(SRAC(q))]\n\nplt.plot(q, ANSC(q), label='ANSC')\nplt.plot(q, LRAC(q), label='LRAC')\nplt.plot(q, MC(q), label='MC = LR Supply', color='k', lw=3)\n\nplt.ylim([1, 5])\nplt.xlim([-0.1, 4])\nplt.xticks([0])\nplt.yticks([])\nplt.legend(loc='best')\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.grid(None)\n```\n:::\n\n\n# Partial Equilibrium\n\nThe equilibrium of a market is a vector of price and quantity for which the market supply and demand are equal. In other words, the equilibrium price is the price that clears the market by equating demand and supply. We have already discussed the market demand curve in the first lecture. We now examine the supply side of the market for which there exists differences between the long run and the short run. \n\n## Short-run equilibrium\n\nIn the short run, the market supply curve is an horizontal aggregation of individual supplies. In other words, to construct the SR market supply curve, one adds up the quantities supplied by all the firms in the market at each given price. The market demand curve is constructed in the same manner. By equating supply and demand, we can determine the market equilibrium.\n\n::: {#exm-SREQ}\nSuppose the market demand is given by $q^D(p) = 100 - 2p.$ Consider a market with $N$ identical firms, each facing the same cost function $C(q)=10−5q+2q^2.$\nIn view of @exr-SRSupply, the SR market supply is given by:\n$$\nq^S(p) =\n\\begin{cases} N(p/4 + 5/4) & p > 4\\sqrt{2.5}-5\\approx 1.32 \\\\\n                     0 & \\mathrm{otherwise.}\n\\end{cases}\n$$\n\nIn equilibrium $q^S(p) = q^D(p)$:\n$$\n\\begin{aligned}\n100 - 2p &= N(p/4 + 5/4) \\\\\np &= \\frac{5(80 - N)}{8 + N}.\n\\end{aligned}\n$$\nHence the market price is a decreasing function of the number of firms. Knowing the shutdown price, we can determine the maximum number of firms that can exist in this market:\n$$\n\\frac{5(80 - N)}{8 + N} = 1.32 \\iff N = 61.6.\n$$\n:::\n\nThe short-run equilibrium quantity is:\n\n$$\nq^* = 100 - 2p^* = \\frac{110N}{8 + N}, \\quad N \\leq 61.\n$$\n\nHence given the number of firms in the market, we can determine its SR supply curve, which together with the market demand curve defines the equilibrium price and quantity. The market shuts down if $N$ is too large.\n\n## Long-run equilibrium\n\nIn a competitive market, firms can freely enter or exit. If there is an opportunity to make __economic profits__ in a market, firms will enter, pushing down market prices and drive away profits. Note that making profits does not imply making economic profits. Economic profits take into account the opportunity cost of the firm. For instance, if leaving money in a bank earns an interest of 5% per month and the firm is generating less than 5% return on investment, it is not making economic profits even though it is making profits. A long-run equilibrium is reached when the following conditions are satisfied:\n\n1. Every firm is __maximizing profits__: $p=MC(q)$\n2. Each firm makes __zero economic profits__: $p=AC(q)$. This means that firms make the same profits in other competitive markets (hence no incentives for other firms to enter or for existing firms to exit)\n3. The market clears: market demand equal to LR market supply at the equilibrium price\n\nHence in a LR equilibrium, firms are doing the best they can do in the market which they have no incentives to leave and no other firms have incentives to enter because of zero economic profits, and the price is such that supply is equal to demand. \n\n::: {exm-LRPartialEQM}\nConsider a perfectly competitive industry populated by identical firms with the cost function $C(q)=10 - 5q + 2q^2$. We would like to determine the long-run equilibrium of the market as well as the equilibrium number of firms operating in it.[^1]\n\n[^1]: Note that we are given a short-run cost function, which has a fixed cost, but we would like to determine the market equilibrium in the long run.\n\nDenote the LR equilibrium quantity, price and market size $q^*$, $p^*$ and $N^*,$ respectively.\n\n* Since each firm in the market sets $MC(q_i^*) = AC(q_i^*)$:\n    $$\n    \\begin{aligned}\n    -5 + 4 q^*_i &= \\frac{10}{q_i^*} - 5 + 2 q_i^* \\\\\n    q_i^* &= \\sqrt{5} \\approx 2.24.\n    \\end{aligned}\n    $$\n    \n* Since $MC(q_i^*) = p^*$, we can deduce the LR equilibrium market price:\n    $$ \n    p^* = -5 + 4 q^*_i = -5 + 4 \\sqrt{5} \\approx 3.94 \n    $$\n    \n* Equilibirum quantity can be found using the market demand equation:\n    $$ \n    q^* = 100 - 2p^* \\approx 92.11 \n    $$\n    \n* The number of active firms in the LR:\n    $$ \n    N^* = \\frac{q^*}{q_i^*} \\approx 41.19 \n    $$\n\n* Hence in the LR equilibrium, the price will be about $\\$3.94$ per unit. At this price about $92$ units will be produced by about $41$ firms.[^2]\n\n:::\n\n# General equilibrium in a pure exchange economy\n\nThe partial equlibrium we consider above concerns a single market. In a general equilibrium analysis, we examine all markets at the same time, taking into account the interconnectedness among different markets. We shall restrict our attention to the case of an exchange economy with two consumers and two consumption goods. Each individual has an initial endowment and they can trade with one another if they wish. \n\nA list or a vector of __endowments__ keeps track of the amount of each good each consumer can enjoy when they do not trade:\n$$ \ne \\equiv (e_1^A, e_2^A;e_1^B, e_2^B).\n$$\n\nThe Edgeworth box is a useful tool to represent an exchange economy with two consumers and two goods. The width and length of the box represent the total endowment of each good.\n\n::: {#fig-EWbox fig-cap=\"An Edgeworth box with two goods and two consumers\nin a pure exchange economy. The total endownment of each good is 10 units. At the intial endowment, agent A has 2 units of $x_1$ and 8 units of $x_2$ whereas agent B has 8 units of $x_1$ and 2 units of $x_2$.\"}\n```{python}\nmm.plotEWBox()\n```\n:::\n\nAn __allocation__ lists the amount of each good that each consumer consumes:\n$$ \nx \\equiv (x_1^A, x_2^A, x_1^B, x_2^B). \n$$\n    \nNote that $x$ can be different from $e$ with trade. An allocation is __feasible__ if the total demand/allocation of each good does not exceed its total supply/endowment. In an economy of $N$ consumers and $L$ goods, this means:\n$$ \n\\begin{aligned}\n\\sum_{i=1}^N x^i_j \\leq \\sum_{i=1}^N e^i_j,\\quad  j=1,\\dots,L.\n\\end{aligned}\n$$\n\nIn our case of interest $i\\in\\{A, B\\}$ and $L=2.$\nObserve that any point inside or on the side of the Edgeworth box is feasible.\n\n::: {#def-GE}\n## General equilibrium in an exchange economy\n\nWe say that a price vector $p\\in\\mathbb{R^L_{++}}$ and an allocation $x\\in\\mathbb{R^L_{+}}$ constitute a competitive general equilibrium in an exchange economy if:\n\n1. The allocation $x$ is feasible\n2. Given prices, $x$ solves the UMP of every consumer\n3. The equilibrium price $p$ clears all markets. This means that the aggregate demand is equal to aggregate supply for each good:\n    $$ \n    q_j^D(p_j) = q_j^S(p_j),\\quad \\forall j=1,\\dots,L. \n    $$\n    In the case of a pure exchange economy, aggregate supply is equal to total endowment\n:::\n\nRecall that for each consumer that has an interior solultion to their UMP, the marginal utility per dollar is equalized across the goods. Mathematically, this condition was:\n\n$$\n    \\frac{U^i_k(x^*)}{p_k} = \\frac{U^i_l(x^*)}{p_l},\n$${#eq-EQMfoc1}\n\nwhere $U^i_k(x^*)$ denotes the partial derivative of $U^i$, the utility function of consumer $i$ with respect to good $k$, evaluated at the optimal consumption bundle $x^{*}$ of this person, and $p_k$ is the price of good $k$. This condition must hold for all goods $k,l=1,\\dots,L$ and for every individual $i=1,\\dots,N$. Observe that @eq-EQMfoc1 is equivalent to:\n\n$$\n% \\begin{aligned}\n    % \\frac{U^i_k(x^*)}{U^i_l(x^*)} &= \\frac{p_k}{p_l} \\\\\n    MRS^i_{k,l}(x^*) = \\frac{p_k}{p_l}, \\quad\\forall i=1,\\dots,N.\n% \\end{aligned}\n$${#eq-EQMfoc2}\n\nHence in equilibrium, the MRS is equal to the price ratio for each individual. This condition together with binding budget constraints will give us the optimal allocation as a function of prices (or more precisely price ratios), which can in turn be determined by the market clearning conditions.  Let us look at an example.\n\n\n::: {#exm-EQM-exchange-eco}\nConsider two consumers with identical preferences represented by a Cobb-Douglas utility function:\n$$\nu(x_1, x_2) = x_1 x_2.\n$$\nTheir initial endowment is:\n\n$$\n\\begin{eqnarray}\ne^A &=& (100, 350) \\\\\ne^B &=& (100, 50)\n\\end{eqnarray}\n$$\nIn autarky each individual can always consumer their endowments. The question is, can they do better with trade? If yes, how much (the allocation), and at which terms (the price ratio)? Let us first solve each individual's UMP, which is:\n$$\n\\begin{aligned}\n&\\max_{x^i} u(x^i) = x_1^i x_2^i,\\\\\n&\\text{s.t. } px^i \\leq pe^i,\\quad i=A,B.\n\\end{aligned}\n$$\nIn optimality:\n$$\nMRS^i_{1,2} = \\frac{p_1}{p_2} \\iff p_1x_1^i = p_2x_2^i.\n$${#eq-FOCexm}\nThe budget constraints bind, implying:\n$$\n\\begin{aligned}\npx^i &= pe^i \\\\\n\\end{aligned}\n$${#eq-BC}\n@eq-FOCexm and @eq-BC provide a system of two equations in two unknowns for each consumer. Solving this system yields:\n$$\n\\begin{aligned}\nx_1^i &= \\frac{pe^i}{2p_1}, \\quad i=A,B \\\\\nx_2^i &= \\frac{pe^i}{2p_2}, \\quad i=A,B. \\\\\n\\end{aligned}\n$${#eq-OptAll}\nIn order to solve for the price ratio, we only need to consider the market clearing condition for $L-1$ markets, which is just a single market in this example. Let us consider this condition for the market of $x_1$:\n$$\n\\begin{aligned}\nx_1^A + x_1^B &= e_1^A + e_1^B \\\\\n\\frac{pe^A + pe^B}{2p_1} &= e_1^A + e_1^B \\\\\np_2(e^A_2 + e^B_2) &= p_1(e_1^A + e_1^B)\n\\end{aligned}\n$$\n\n$$\n\\frac{p_2}{p_1} = \\frac{e_1^A + e_1^B}{e_2^A + e_2^B}.\n$${#eq-OptPrice}\nSubstituting the specific values of endownments into @eq-OptAll and @eq-OptPrice, we obtain the equilibrium allocation and price ratio. In particular:\n\n$$\n\\begin{aligned}\n(x_1^A, x_2^A) &= (137.5,275), \\\\\n(x_1^B, x_2^B) &= (62.5,125), \\\\\n\\frac{p_2}{p_1} &=\\frac{1}{2}.\n\\end{aligned}\n$$\n\nObserve that in equilibrium, the first good is twice as valuable as the first one. This is no coincidence: each consumer extracts the same utility from each good, and yet the second one is twice as abundant as the first.\n:::\n\n\n::: {#rem-RemQM} \nNote that in a market of $L$ goods, one good is chosen as a numeraire and the price ratios give us the prices of the other goods in the units of the numeraire. In a sense, this gives us the _real_ prices of goods, which, rather than _nominal_ prices, matter for optimal allocation. One can verify this intuition quickly by imagining a situation when prices double for all goods (i.e., water raises all boats by the same proportion): the nominal value of wealth doubles, but so does the cost of consumption, hence the optimal allocation should not be modified.\n:::\n\n# Welfare theorems\n\nThe equilibrium we have found in the previous section is called a competitive equilibrium. It is _competitive_ in the sense that each person does what is in the best interest and the markets clear at the equilibrium prices. This is also referred to as a decentralized equilibrium because it is not the result of some benevolent central authority allocating aggregate resources in a way that they judge best. \n\nEconomic decisions are all about efficient allocation of resources. Economic problems exist because resources are scarce. A natural question arises, then, is the __competitive equilibrium allocation (CEA)__ obtained by each one acting in their best interest, efficient?\n\nIn economics, the notion of efficiency of interest is Pareto efficiency. We say that an allocation is __Pareto efficient__ if there exists no other allocation that is strictly better off for someone without being worse off for someone else. In other words, an efficient allocation is one that cannot be improved for someone without hurting someone else. In a market with no market failures, it can be shown that under mild conditions, a CEA is Pareto efficient. This is the first welfare theorem (FWT). Graphically, the Pareto efficient allocation lies at the tangency of any two ICs in the Edgeworth box. This means that such allocations are not unique, and in fact the locus of all __Pareto efficient allocations (PEA)__ forms the so-called __contract curve__. How come we found only one of them in the previous example? This is because which Pareto efficient allocation can be achieved by market forces alone depends on the initial endowment. If we want to alter the outcome, we need to modify the starting point. This is the idea behind the second welfare theorem (SWT).\n\nAnother natural question that one might ask is why would an economy prefer a different Pareto efficient allocation? Why bother redistributing resources to incentivise the market to achieve a different allocation at all? It is because on top of efficiency, societies also care about equality. If one starts out with abundant resources, then market forces alone tend to lead to an efficient allocation that gives more to the haves and less to the have-nots. \n\nTo sum up, the FWT tells us that when there are no market failures, the CEA is Pareto efficient. The SWT says that any Pareto efficient, i.e., any point on the contract curve, can be obtained by redistributing initial resources and then letting the market work (again under some conditions). Let us state these important results formally.\n\n::: {#thm-FWT}\n## First welfare theorem\nEvery competitive equilibrium allocation is Pareto efficient.\n:::\n\n::: {#thm-SWT}\n## Second welfare theorem\nConsider an a efficient allocation $\\bar{x}$ and a _redistribution_ of the initial endowment from $e$ to $\\bar{e}$ such that $p\\bar{e}^i = p\\bar{x}^i$ for every individual $i=A, B$. Then every efficient allocation can be supported by a competitive equilibrium allocation.\n:::\n\nLet us illustrate the SWT by continuing with @exm-EQM-exchange-eco. The condition for an allocation to be a CEA was:\n$$\n\\begin{eqnarray}\nMRS_{1,2}^A(x^A) &=& MRS_{1,2}^B(x^B) = \\frac{p_1}{p_2} \\\\\n\\frac{x_2^A}{x_1^A} &=& \\frac{x_2^B}{x_1^B} = \\frac{1}{2}.\n\\end{eqnarray}\n$$\nHence any allocation satisfying $x_2^i = 2 x_1^i$ is a CEA, which is also a PEA by the FWT. Given the initial endowment, we have obtained for this example:\n\n$$\n\\begin{aligned}\n(x_1^A, x_2^A) &= (137.5,275), \\\\\n(x_1^B, x_2^B) &= (62.5,125).\n\\end{aligned}\n$$\n    \nBut this is not the only PEA. For example, another PEA satisfying $x_2^i = 2 x_1^i$ is \n$$\n\\bar{x}^i \\equiv (x_1^i, x_2^i) = (100, 200), \\quad i=A,B.\n$$\nCan this this PEA emerge as a CEA? The SWT tells us yes. According to the SWT, we need to modify the initial endowments in such a way that the budget constraint still binds for each consumer:\n$$\n\\begin{aligned}\np\\bar{x}^i &= p\\bar{e}^i \\\\\np_1 \\bar{x}_1^i + p_2 \\bar{x}_2^i &= p_1 \\bar{e}_1^i + p_2 \\bar{e}_2^i \\\\\n\\bar{x}_1^i + \\frac{p_2}{p_1} \\bar{x}_2^i &= \\bar{e}_1^i + \\frac{p_2}{p_1} \\bar{e}_2^i\n\\end{aligned}\n$$\n\n$$\n\\therefore \\bar{x}_1^i + 2\\bar{x}_2^i = \\bar{e}_1^i + 2\\bar{e}_2^i.\n$${#eq-temp}\n\nSubstituting the values of the new PEA into @eq-temp for each consumer, we obtain two equations in four unknowns $\\bar{e}_1^A, \\bar{e}_2^A, \\bar{e}_1^B, \\bar{e}_2^B$. We need two other equations to solve for these unknowns; they come from the market clearing conditions. Putting all this together, we obtain the following system:\n$$\n\\begin{aligned}\n\\bar{x}_1^A + 2\\bar{x}_2^A &= \\bar{e}_1^A + 2\\bar{e}_2^A, \\\\\n\\bar{x}_1^B + 2\\bar{x}_2^B &= \\bar{e}_1^B + 2\\bar{e}_2^B, \\\\\n\\bar{x}_1^A + \\bar{x}_1^B &= \\bar{e}_1^A + \\bar{e}_1^B, \\\\\n\\bar{x}_2^A + \\bar{x}_2^B &= \\bar{e}_2^A + \\bar{e}_2^B.\n\\end{aligned}\n$$\n    \nNote that only three of the four equations from the system above are linearly independent (one degree of freedom), implying that solutions are not unique.\nOne immediate solution is $\\bar{e} = \\bar{x}$. In other words, if we give each individual a PEA, they will stick to it.\nObserve that\n$$\n\\begin{aligned}\ne &= (100, 350, 100, 50) \\\\\n\\bar{e} &= (100, 200, 100, 200).\n\\end{aligned}\n$$\nThus one way to redistribute is to tax $A$ an amount equivalent to 150 units of the first good and give them to $B$. \n\n\n# General equilibrium with production\n\n## Adding production to the economy\n\nIn a production economy, consumers own factors of production, which they can rent out to firms to earn income. Firms choose the quantity of factors of production to maximize profit, taking as given the prices (of factors and final consumption goods). Consumers choose the quantity of consumption goods to maximize utility, taking as given prices (of factors and final consumption goods). \nIn equilibrium, aggregate demand is equal to aggregate supply in each market, including markets of production factors.\n    \nConsider an economy two consumers with Cobb-Douglas utility function\n$$\nu(x_1^i, x_2^i) = x_1^i x_2^i\n$$ \nfor each consumer $i=A, B$ whose endowments are:\n$$\n\\begin{aligned}\ne^A &= (k^A, l^A), \\\\\ne^B &= (k^B, l^B).\n\\end{aligned}\n$${#eq-endowment}\n    \nSuppose there are two firms in the economy, each producing one of the consumption goods according to a Cobb-Douglas technology:\n$$\n\\begin{aligned}\ny_1 = F^1(K_1, L_1) &= K_1^a L_1^b, \\\\\ny_2 = F^2(K_2, L_2) &= K_2^b L_2^a,\n\\end{aligned}\n$$\nwhere $a+b=1$ and $a, b \\in (0,1)$.\n    \nAn allocation $(x_1^A, x_1^B, x_2^A, x_2^B, K_1, L_1, K_2, L_2)$ and a price vector $p=(p_1, p_2, w, r)$ constitute a competive equilibrium (or Walrasian equilibrium) of the production economy if:\n\n1. Given prices, $(x_1^i, x_2^i)$ solves the UMP for each consumer $i\\in\\{A,B\\}.$\n\n2. Given prices, $(K_j, L_j)$ solves the PMP for each firm $j\\in \\{1,2\\}.$\n\n3. Prices are such that markets clear:\n    $$\n    \\begin{aligned}\n    \\text{Consumption goods:   }\\sum_i x^i_j &= y_j \\equiv F^j(K_j, L_j), \\quad \\forall j=1,2, \\\\\n    \\text{Capital good:   }\\sum_j K_j &= k^A + k^B, \\\\\n    \\text{Labor good:   }\\sum_j L_j &= l^A + l^B.\n    \\end{aligned}\n    $$\nIn other words, we are in an equilibrium if ever agent optimizes and markets clear. Let us first consider the consumers, who face the UMP.\n\n## UMP\n\nConsumer $i$ solves:\n$$\n\\begin{aligned}\n&\\max_{x^i} u(x^i) \\\\\n&\\text{s.t. } px^i \\leq wl^i + rk^i.\n\\end{aligned}\n$${#eq-UMP}\n\nObserve that since consumers own labor and capital, their income come from renting out these factors of production.\nThe FONC yields:\n$$\nu'_j(x^i) = \\lambda_i p_j, \\quad\\forall j=1,2.\n$${#eq-FOC_UMP}\n\nSince $u'_j>0$ we must have $\\lambda > 0$ in optimality, implying that the BC binds:\n$$\npx^i = wl^i + rk^i.\n$$\n    \nMoreover:\n$$\nMRS_{1,2}^i = \\frac{p_1}{p_2},\\quad \\forall i\\in\\{A,B\\}.\n$${#eq-MRS_i}\n    \n@eq-MRS_i implies:\n    \n$$\n\\frac{x^i_2}{x^i_1} = \\frac{p_1}{p_2} \\quad \\forall i, \n$$\n    \nwhich together with the binding BC provide the optimal consumption bundle for each consumer as function of factor prices and endowments. In particular:\n    \n$$\nx_j^i = \\frac{wl^i + rk^i}{2p_j},\\quad i\\in\\{A, B\\},\\quad j\\in\\{1, 2\\}.\n$${#eq-demand_conso}\n  \nDenote the total endowment $l=\\sum_i l^i$ and $k= \\sum_i k^i.$\nBy the market clearing condition for good 1: \n$$\n\\begin{aligned}\nx_1^A + x_1^B &= y_1 = F^1(K_1, L_1) = K_1^a L_1^b \\\\\n\\frac{wl + rk}{2p_1} &= K_1^a L_1^b.\n\\end{aligned}\n$${#eq-MC_x1}\n    \nLikewise for the second good:\n$$\n\\frac{wl + rk}{2p_2} = K_2^b L_2^a.\n$${#eq-MC_x2}\n    \nDividing @eq-MC_x2 by @eq-MC_x1 side by side yields:\n$$\n\\frac{p_1}{p_2} = \\frac{K_2^b L_2^a}{K_1^a L_1^b}.\n$${#eq-prices_UMP}\n\nNext we consider firms, who seek to maximize profits.\n\n## PMP\n\nEach firm $j=1,2$ solves their profit maximization problem (PMP):\n    \n$$\n\\max_{K_j, L_j} \\pi_j = p_j F^j(K_j, L_j) - rK_j - wL_j.\n$${#eq-PMPj}\n    \nIn optimality:\n$$\np_j F_K^j = r, \\quad p_j F_L^j = w.\n$${#eq-PMPj_FOC}\n\nHence: \n$$\n\\begin{aligned}\n\\frac{p_1}{p_2} &= \\frac{F_K^2}{F_K^1} = \\frac{F_L^2}{F_L^1} \\\\\n\\frac{p_1}{p_2}&= MRT_{1,2}^K = MRT_{1,2}^L.\n\\end{aligned}\n$${#eq-prices_PMP}\n\nThe $MRT^K_{1,2}$ is the rate at which the economy transforms the second good into the first good using capital. Observe that @eq-MRS_i and @eq-prices_PMP together say that at an optimum, the economy transforms one good for the other at the rate consumers are willing to substitute one for the other. From @eq-prices_UMP and @eq-prices_PMP and the fact that $a+b=1,$ we have:\n$$\n\\begin{aligned}\n\\frac{p_1}{p_2} = \\frac{F_K^2}{F_K^1} &= \\frac{K_2^b L_2^a}{K_1^a L_1^b} \\\\\n\\frac{b K_2^{b-1} L_2^a}{a K_1^{a-1} L_1^b} &= \\frac{K_2^b L_2^a}{K_1^a L_1^b} \\\\\n\\implies \\frac{K_2}{K_1} &= \\frac{b}{a}.\n\\end{aligned}\n$${#eq-rels_K}\n\nWe will now solve for the CEA of this economy using the market clearing conditions.\n\n## The CEA\n\nCombining @eq-rels_K and the market clearing condition for the capital market $K_1 + K_2 = k,$ we can solve for the optimal values of capital. In particular,\n\n$$\nK_1 = a k, \\quad K_2 = b k.\n$${#eq-allo_K}\n\nFrom @eq-prices_UMP and @eq-prices_PMP and the fact that $a+b=1,$ we have:\n$$\n\\frac{L_2}{L_1} = \\frac{a}{b}.\n$${#eq-rels_L}\n\nAgain, combining @eq-rels_L and the market clearing condition for the labor market $L_1 + L_2 = l,$ we obtain:\n    \n$$\nL_1 = a l, \\quad L_2 = bl.\n$${#eq-allo_L}\n\nHaving computed factor demands, we can substitute these values into @eq-prices_UMP to determine equilibrium price ratio $p_1/p_2$. We can then normalize $p_2\\equiv 1,$ to obtain:\n$$\np_1 = \\frac{b}{a}\\left(\\frac{k}{l}\\right)^{b-a}.\n$${#eq-price_x1}\n    \nFactor prices can then be determined from @eq-PMPj_FOC. The equilibrium allocations $x^A, x^B$ can be determined by substituting factor and consumption prices into @eq-demand_conso.\n\n# The social planner's problem (SPP)\n\nIn a centralized economy, the benevolent social planner allocates resources in such a way that maximizes a social welfare function (weighted sum of utilities) subject to some feasibility constraints. A solution to the social planner's problem is Pareto efficient. \n\n## The SPP in a pure-exchange economy\nMathematically, the social planner solves:\n$$\n\\begin{aligned}\n&\\max_{(x^i)_{i\\in I}} \\sum_{i\\in I} w^i u^i(x^i) \\\\\n&\\text{s.t. } \\sum_{i\\in I} x^i_j \\leq \\sum_{i\\in I} e^i_j, \\quad \\forall j\\in J,\n\\end{aligned}\n$${#eq-SPP_exchange}\n\nwhere $w_i$ are social welfare weights. Note that there are no prices in the social planner's problem (SPP), why is that? In a decentralized economy, selfish interest and prices guide individuals to efficient decisions. In a centralized economy, the social planner knows what is best and does not need prices as signals to allocate resources efficiently. \n\n## The PEA in a pure exchange economy\n\nThe KKT conditions for the SPP's problem:\n$$\n\\begin{aligned}\n    w^i u^i_j(x^i) &= \\lambda_j, \\quad \\forall j\\in J, \\: i\\in I, \\\\\n    \\sum_{i\\in I} x^i_j &= \\sum_{i\\in I} e^i_j, \\quad \\forall j\\in J.\n\\end{aligned}\n$$\n\nConsumers have identical preferences. Hence:\n$$\n\\begin{aligned}\nw^A u^A_j(x^A) &= w^B u^B_j(x^B) = \\lambda_j\\\\\nw^A x_j^A &= w^B x_j^B, \\\\\n\\implies \\frac{x_j^A}{x_j^B} &= \\frac{w^A}{w^B}, \\quad j=1,2.\n\\end{aligned}\n$$\n\nThis together with the binding feasibility constraints characterize the PEA for this economy:\n    \n$$\nx^A = w^A e, \\quad x^B = w^B e.\n$$\n    \nThus in a pure exchange economy the PEA is proportional to the social weight of the individual. If the social weights are equal, the aggregate endowments will be divided equally among the consumers. In general the results will be different if social weights are different or preferences are different among consumers.\n    \n## The SPP in a production economy\n\nAccording to the FWT the CEA in the production economy also Pareto efficient. Let us show that the CEA is also a PEA, i.e., that the FWT is verified in this production economy.\nA PEA consists of a vector of consumption goods and factors of production $(x_i)_{i\\in I}, (K_j, L_j)_{j=J}$ that maximizes aggregate welfare subject to feasibility constraints.\n\n## The PEA in a production economy\n\nThe social planner's problem for a production economy reads:\n\n$$\n\\begin{aligned}\n&\\max_{(x^i)_{i\\in I}, (K_j, L_j)_{j\\in J}} \\sum_{i\\in I} w^i u^i(x^i) \\\\\n\\text{s.t. }&\\begin{cases}\n                \\sum_{i\\in I} x^i_j \\leq F(K_j, L_j) \\:\\forall j \\\\\n                \\sum_{j\\in J} K_j \\leq \\sum_i k^i \\equiv k \\\\\n                \\sum_{j\\in J} L_j \\leq \\sum_i l^i \\equiv l\n\\end{cases}\n\\end{aligned}\n$${#eq-SPP}\n\nwhere $w_i$ are social welfare weights.\n\n::: {#rem-SPPProdEco}\nObserve that the first constraint in the SPP is the feasibility constraint on each consumption good.\nThe last two constraints are feasibility constraints on the factors of production.\n:::\n\nTo solve the SPP, we first set up the Lagrangian:\n\n$$\n\\begin{aligned}\n\\mathcal{L} &= \\sum_{i\\in I} w^i u^i(x^i) \\\\\n&+ \\sum_{j\\in J} \\lambda_j\\left[F(K_j, L_j) - \\sum_{i\\in I}x^i_j\\right] \\\\\n&+ \\mu_K (k - \\sum_{j\\in J} K_j) \\\\\n&+ \\mu_L (l - \\sum_{j\\in J} L_j).\n\\end{aligned}\n$${#eq-SPP_Lang}\n    \nThe FOCs yield:\n\n$$\n\\begin{aligned}\n    \\frac{\\partial \\mathcal{L}}{\\partial x^i_j} &= 0 \\iff w^i u^i_j(x^i) = \\lambda_j, \\quad \\forall j\\in J, \\: i\\in I, \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial K_j} &= 0 \\iff \\lambda_j MPK_j = \\mu_K, \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial L_j} &= 0 \\iff \\lambda_j MPL_j = \\mu_L. \n\\end{aligned}\n$$\n\nObserve that $\\lambda_j>0$ for all good $j$ and $\\mu_K>0$, $\\mu_L>0$, implying that the feasibility constraints bind at a PEA. \nFrom the FOC w.r.t to the consumption good we obtain:\n$$\nMRS^A_{1,2}(x^A) = MRS^B_{1,2}(x^B).\n$${#eq-SPP_FOC}\n    \nFrom the FOC w.r.t to factors:\n    \n$$\n\\begin{aligned}\n    \\lambda_1 MPK_1 = \\lambda_2 MPK_2 \\iff \\frac{\\lambda_1}{\\lambda_2} &= MRT^K_{1,2} \\\\\n    \\lambda_1 MPL_1 = \\lambda_2 MPL_2 \\iff \\frac{\\lambda_1}{\\lambda_2} &= MRT^L_{1,2} \\\\\n    \\frac{MPK_1}{MPL_1} = \\frac{MPK_2}{MPL_2} \\iff MRTS^1_{K,L} &= MRTS^2_{K,L}.\n\\end{aligned}\n$$\n\nThese conditions being satisfied by the CEA, implying that the CEA is also a PEA.\n\n\n# Exercises\n\n::: {#exr-SRSupply}\n\nConsider a firm with the total cost function $C(q)=10−5q+2q^2$. Assume that this fixed cost is evenly distributed into sunk costs, $\\$5$, and non-sunk costs, $\\$5$. Show that the firm's SR supply curve is given by:\n\n$$\nq(p) =\n\\begin{cases} p/4 + 5/4 & p > 4\\sqrt{2.5}-5\\approx 1.32 \\\\\n                     0 & \\mathrm{otherwise.}\n\\end{cases}\n$$\n\n\n<details>\n<summary>Answer</summary>\n\n* The nonsunk cost is $NSC(q) = 5 - 5q + 2q^2$\n\n* Effectively we maximize $pq - NSC(q)$ (we forget about the sunk costs), which is convex in $q$\n\n* FOC gives: $$p = MC(q) \\iff p = 4q - 5 \\iff q = (p+5)/4$$\n\n* Firm produces iff revenue covers nonsunk costs, i.e., if price is greater than ANSC. Shutdown point (crossing point between MC and ANCS): \n\n    $$\n    p = MC(q) = ANSC(q) = \\frac{5}{q}-5+2q \\\\\n    \\iff q=\\sqrt{2.5}\n    \\implies p = 4\\sqrt{2.5} - 5 \\approx 1.32.\n    $$ \n    \n    * Below $p=1.32$, the firm shuts down since it cannot recover nonsunk costs\n\n</details>\n:::\n\n\n::: {#exr-LRPEQM}\n\nConsider a perfectly competitive industry populated by identical firms with the cost function $C(q)=10 - 5q + 2q^2$. Suppose the market demand is given by $q^D(p) = 400 - 2p$.\nDetermine the long-run equilibrium price, quantity and the number of firms. \n\n<details>\n<summary>Answer</summary>\nSee @exr-LRPEQM. Observe the change in demand and equilibrium of the market.\n</details>\n:::\n\n::: {#exr-PEPOpt}\nConsider a two-person two-good economy with the following preferences:\n$$\n\\begin{align}\n    u_1(x_1, y_1) &= x_1y_1, \\\\\n    u_2(x_2, y_2) &= x_2y_2^2,\n\\end{align}\n$$\nwhere $x_i$ and $y_i$ the amounts of good $x$ and good $y$ that individual $i$ consumes, respectively. Suppose that the first person has an initial endowment of $40$ units of $x$ and $160$ units of $y$ while the second has $240$ units of $x$ and $120$ units of $y$. \n\n1. Represent this economy using and Edgeworth box.\n2. Define and compute the competitive equililibrium of this economy. Are the consumers better off with exchange (compared to eating their own endowments)?\n3. Define and solve the social planner's problem for this economy and determine the set of Pareto efficient allocations (the contract curve) of this economy. \n4. Does the first welfare theorem hold for this economy? \n:::\n\n\n\n\n    \n","srcMarkdownNoYaml":"\n\n\n```{python}\n%load_ext autoreload\n%autoreload 2\n```\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport seaborn as sns\nimport pandas as pd\nimport dataframe_image as dfi\nimport ipywidgets as widgets\nfrom IPython.display import display\nfrom ipywidgets import interact\nimport pandas as pd\n```\n\n```{python}\nimport sys\nimport os\nmod_dir = os.path.join(os.getcwd(), 'modules')\nif mod_dir not in sys.path:\n    sys.path.append(mod_dir)\n\nimport micro_modules as mm\nmm.load_viz_settings()\n```\n\n```{python}\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n```\n\nIn this chapter we will be examining market equilibria. We shall begin by deriving the market supply curve, which results from firms' optimal production decision. Likewise, market demand results from consumers' optimal consumption decision. Searching for an equilibrium is essentially searching for prices that equalize demand and supply in the market. When a single market is considered in isolation, its equilibrium is a partial one. When all markets are considered, we speak of a general equilibrium. In a pure exchange economy, all markets are markets of consumption goods. In  a production economy, the relevant markets include those of factors of production such as labor, capital and land. In this course, we will be mostly interested in general equilibria in a pure exchange economy. \n\n# Perfectly competitive markets\n\nOur markets in this chapter are perfectly competitive, their features are:\n\n* Fragmentation: large number of producers and consumers whose decisions (to produce or consume) do not influence market prices of the goods. In other words, all market participants are price-takers\n\n* Undifferentiated products: products of all firms in the same industry are regarded as identical by consumers\n\n* Perfect information: information on prices are transparent and freely accessible by consumers\n\n* Free entry and exit: in the long run (LR), firms can freely enter and exit \n\nExample: Wheat, corn, or agricultural commodities\n\n# Firm's profit maxmimization problem (PMP)\n\n## The PMP\n\n<!-- * Is the dual problem of the cost minimization problem (CMP) introduced previously\n    * In that problem, we implicitly assumed that firms were price-takers in the markets of inputs -->\n\n::: {#def-PMP}\n## Firm's PMP\nConsider a price-taking firm in the market of the output good\nGiven $p$, the market price of the good, every firm's PMP is:\n$$\n\\max_{q\\geq 0} \\pi = R(q) - C(q) = pq - C(q), \n$$\nwhere $C(q)$ is the total cost function derived from the CMP introduced previously, $R(q)$ denotes the total revenue. \n:::\n    \nObserve that the PMP includes the CMP as a first step\n\n## Necessary conditions\n\nAccording to the KT conditions, either \n\n* we have a corner solution $q=0$, or\n\n* We have an interior solution $q>0$ satisfying the FOC:\n\n    $$\n        \\pi'(q) = 0 \\iff p = C'(q) \\\\\n        \\iff p = MC(q).\n    $$\n    \n* Observe that for a price-taking firm, the marginal revenue is the market price of the good (as we shall see later, for a firm with market power, the marginal revenue is _less_ than the price)\n\n* The FOC above implies that the firm produces up to a point where the marginal revenue (marginal benefit) is equal to the marginal cost. \n    \n## Sufficient condition\n\n* The FOC is sufficient for a max if the profit function is concave  in output. This is called the second-order condition (SOC)\n\n* We have:\n\n    $$ \n    \\pi''(q) = -C''(q), \n    $$\n    \n    implying that the SOC is satisfied if the cost function is convex in $q$ (i.e., if the MC is increasing in output)\n\n\n    \n## Examples\n\n::: {#exm-ESCex}\nLet us solve the PMP of a price-taking firm in the output market (and inputs market). Assume that it has a Cobb-Douglas production function defined by $q(L, K) = L^{1/2}K^{1/2}$. The factor prices are $w=\\$40$ and $r=\\$10$ as before.\n\n* Step 1: Solve the CMP:\n\n    $$\n    \\begin{aligned}\n    &\\min_{K,L} 40L + 10K \\\\\n    \\text{s.t. } &q(L, K) = L^{1/2}K^{1/2} \\geq q, \n    \\end{aligned}\n    $$\n    \n    for some target output level $q$. \n    \n    * The cost function can be obtained by replacing the solutions of the CMP into the objective function. This yields: \n    \n    $$\n    C(q) = 40q. \n    $$\n\n\n* Step 2: Substitute $C(q)$ obtained from the CMP into the PMP so that this problem reads:\n\n    $$\n    \\max_{q\\geq0} \\pi(q) = pq - 40q = (p - 40)q. \n    $$\n    \n    * Clearly if $p<40$ the firm should shut down\n    \n    * If $p\\geq 40$, the firm produces as much as possible since the profit is then incresing in output\n    \n    * We thus obtain a perfectly elastic individual supply curve\n\n    * Note that this is the long-run individual supply curve since all inputs are variable. One can also verify that the long-run cost function does not have a fixed cost. \n\n::: {#fig-PEScurve fig-cap=\"A perfectly elastic long-run supply curve\"}\n```{python}\nq = np.linspace(0, 5, 100)\np = np.ones(len(q)) * 40\nplt.plot(q, p, lw=2)\nplt.vlines(x=0, ymin=0, ymax=40, lw=2)\nplt.xlabel('Quantity ($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.ylim([0, 60])\nplt.xticks([0])\nplt.yticks([40])\nplt.grid(False)\nplt.show()\n```\n:::\n:::\n\n::: {#exm-linearSC}\nSuppose we have obtained a convex cost function for the firm of the form:\n$$\nC(q) = 0.5 a q^2 + bq + c, \n$$\nwhere $a$, $b$ and $c$ are strictly positive constants. Observe that this is a short-run cost function since fixed costs ($c$) are present. \nThe profit maximizing condition for the firm is:\n$$\nC'(q) = a q + b = p \\iff q = \\frac{p - b}{a}. \n$${#eq-optimal-SR-supply}\n\nTo determine the short-run supply curve of the firm, we need to understand the nature of the fixed costs represented by $c.$ In the short-run, firms are typically do not try to make positive profits, i.e., they do not need to sell each unit for at least their average total cost. Firms only need to recuperate the non-sunk part of the fixed cost. __Sunk__ costs are fixed costs that cannot be recovered by the firm and thus should not affect its decision on future output. For example, advertising costs once spent cannot be recovered. Lease payments, on the other hand, are __non-sunk__ fixed costs can be recovered by sublease if the firm eventually decides to shut down.\n\nFor simplicity, suppose that $c$ is non-sunk. The average total cost in this case is equal to the average non-sunk total cost (ANSC).The firm produces so long as the market price is above the ANSC:\n$$\n\\begin{aligned}\n\\pi(q^*) > 0 &\\iff p > \\frac{C(q^*)}{q^*} \\\\\n&\\iff p > 0.5 a q^* + b + \\frac{c}{q^*} \\\\\n&\\iff p > 0.5 a \\frac{p - b}{a} + b + \\frac{ca}{p - b} \\\\\n&\\iff (p - b)^2 > 2ca \\\\\n&\\iff p > b + \\sqrt{2ca}.\n\\end{aligned}\n$${#eq-positive-prof-cond}\n\nObserve that the last line follows from the fact that $q^* > 0$ if and only if $p > b$ in view of @eq-optimal-SR-supply. This condition tells us that in the SR, the firm suffers from a fixed cost ($c$), which might prevent it from earning positive profits even if it is operating optimally. Note that $p > b + \\sqrt{2ca}$ is equivalent to $q > \\sqrt{2c/a}.$\n\n\n::: {#fig-profFunc fig-cap=\"Profit as a function of market price\"}\n```{python}\na, b, c = 1, 1, 2\ndef costFunc(q):\n    return 0.5 * a * q**2 + b * q + c\ndef profFunc(q, p):\n    return q * p - costFunc(q)\ndef optQ(p):\n    return (p - b) / a\nq = np.linspace(0, 5, 100)\npricelabs = ['low price', 'break-even price', 'high price']\n# plt.plot(q, costFunc(q))\nfor p in range(3):\n    plt.plot(q, profFunc(q, p+2), label=pricelabs[p])\n    plt.ylim([-7, 5])\n    plt.xlim([0, 5])\n    plt.xlabel('Quantity ($q$)', loc='right')\n    plt.ylabel('Profit ($\\pi$)', loc='top')\n    plt.legend(loc='lower left')\n    plt.hlines(y=0, xmin=0, xmax=5, linestyle='--', color='gray')\n    plt.grid(None)\n    plt.yticks([0])\n    plt.xticks([0])\n```\n:::\n\n::: {#fig-linearSC fig-cap=\"A SR upward sloping supply curve $q = \\frac{p - b}{a}$ for $p > b + \\sqrt{2ac}$\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\nq = np.linspace(q_min, 5, 100)\np_min = b + np.sqrt(2 * a * c)\np = a * q + b \nplt.plot(q, p, lw=2)\nplt.vlines(x=0, ymin=0, ymax=p_min, lw=2)\nplt.vlines(x=q_min, ymin=0, ymax=p_min, linestyle='dotted', color='gray')\nplt.hlines(y=p_min, xmin=0, xmax=q_min, linestyles='dotted', color='gray')\nplt.ylim([0.5, 6])\nplt.xlim([-0.04, 4])\nplt.text(-1, 0.95 * p_min, '$b + \\sqrt{2ac}$')\nplt.text(q_min * 0.8, 0.15, r\"$\\sqrt{2c/a}$\")\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.xticks([0])\nplt.yticks([])\nplt.grid(None)\nplt.tight_layout\nplt.show()\n```\n:::\n:::\n\n## Long-run vs short-run firm's supply\n\nThe profit maximizing condition for a competitive firm is that its marginal cost is equal to the market price. This is common for the firm both in the long run and in the short run. The difference lies in the shutdown condition. \n\nIn the short run, firms shutdown if the price cannot cover the average non-sunk costs (ANSC), implying that supply will be:\n\n* zero for all levels of output for which the marginal cost (which is equal to the market price under profit maximizing) is _below_ the ANSC curve, and\n* the part of the marginal cost that is _above_ the ANSC (when output is positive) \n\n\n::: {#fig-SRSC fig-cap=\"SR supply curve\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\np_min = b + np.sqrt(2 * a * c)\nq = np.linspace(0.1, 5, 100)\ndef LRAC(q):\n    return (costFunc(q) - c) / q \ndef ANSC(q):\n    return (costFunc(q) - c / 2) / q \ndef SRAC(q):\n    return costFunc(q) / q \ndef MC(q):\n    return a * q + b\n\nANSC_min = q[np.argmin(ANSC(q))]\nSRAC_min = q[np.argmin(SRAC(q))]\n\nplt.plot(q, MC(q), label='MC', color='gray')\nplt.plot(q, ANSC(q), label='ANSC')\nplt.plot(q, SRAC(q), label='SRAC')\n# plt.plot(q, LRAC(q), label='AVC or LRAC')\nplt.vlines(x=0.1, ymin=0, ymax=ANSC(q).min(), lw=3, color='k')\n\nqnew = np.linspace(ANSC_min, 4, 100)\nplt.plot(qnew, MC(qnew), color='k', lw=3, label='SR Supply')\nplt.ylim([1, 5])\nplt.xlim([-0.1, 4])\nplt.xticks([0])\nplt.yticks([])\nplt.legend(loc='best')\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.grid(None)\n```\n:::\n\nIn the long run, all costs are variable. The average cost (AC) is just the average variable cost (AVC). The firm produces so long as the market price can cover the AVC (or the AC), hence the LR supply curve will be:\n\n* zero for all levels of output for which the marginal cost (which is equal to the market price under profit maximizing) is _below_ the AC (or AVC) curve, and\n* the part of the marginal cost that is _above_ the AC (or AVC) \n\nNote that the SR firms might suffer from losses due to non-sunk fixed costs, but so long as the price can cover the ANSC, it is optimal for them to produce. In the LR, however, the firm produces so long as it earns positive profits and shuts down otherwise.\n\n::: {#fig-LRSC fig-cap=\"LR supply curve\"}\n```{python}\na, b, c = 1, 1, 2\nq_min = np.sqrt(2 * c / a)\np_min = b + np.sqrt(2 * a * c)\nq = np.linspace(0.1, 5, 100)\ndef LRAC(q):\n    return (costFunc(q) - c) / q \ndef ANSC(q):\n    return (costFunc(q) - c / 2) / q \ndef SRAC(q):\n    return costFunc(q) / q \ndef MC(q):\n    return a * q + b\n\nANSC_min = q[np.argmin(ANSC(q))]\nSRAC_min = q[np.argmin(SRAC(q))]\n\nplt.plot(q, ANSC(q), label='ANSC')\nplt.plot(q, LRAC(q), label='LRAC')\nplt.plot(q, MC(q), label='MC = LR Supply', color='k', lw=3)\n\nplt.ylim([1, 5])\nplt.xlim([-0.1, 4])\nplt.xticks([0])\nplt.yticks([])\nplt.legend(loc='best')\nplt.xlabel('Quantity($q$)', loc='right')\nplt.ylabel('Price ($p$)', loc='top')\nplt.grid(None)\n```\n:::\n\n\n# Partial Equilibrium\n\nThe equilibrium of a market is a vector of price and quantity for which the market supply and demand are equal. In other words, the equilibrium price is the price that clears the market by equating demand and supply. We have already discussed the market demand curve in the first lecture. We now examine the supply side of the market for which there exists differences between the long run and the short run. \n\n## Short-run equilibrium\n\nIn the short run, the market supply curve is an horizontal aggregation of individual supplies. In other words, to construct the SR market supply curve, one adds up the quantities supplied by all the firms in the market at each given price. The market demand curve is constructed in the same manner. By equating supply and demand, we can determine the market equilibrium.\n\n::: {#exm-SREQ}\nSuppose the market demand is given by $q^D(p) = 100 - 2p.$ Consider a market with $N$ identical firms, each facing the same cost function $C(q)=10−5q+2q^2.$\nIn view of @exr-SRSupply, the SR market supply is given by:\n$$\nq^S(p) =\n\\begin{cases} N(p/4 + 5/4) & p > 4\\sqrt{2.5}-5\\approx 1.32 \\\\\n                     0 & \\mathrm{otherwise.}\n\\end{cases}\n$$\n\nIn equilibrium $q^S(p) = q^D(p)$:\n$$\n\\begin{aligned}\n100 - 2p &= N(p/4 + 5/4) \\\\\np &= \\frac{5(80 - N)}{8 + N}.\n\\end{aligned}\n$$\nHence the market price is a decreasing function of the number of firms. Knowing the shutdown price, we can determine the maximum number of firms that can exist in this market:\n$$\n\\frac{5(80 - N)}{8 + N} = 1.32 \\iff N = 61.6.\n$$\n:::\n\nThe short-run equilibrium quantity is:\n\n$$\nq^* = 100 - 2p^* = \\frac{110N}{8 + N}, \\quad N \\leq 61.\n$$\n\nHence given the number of firms in the market, we can determine its SR supply curve, which together with the market demand curve defines the equilibrium price and quantity. The market shuts down if $N$ is too large.\n\n## Long-run equilibrium\n\nIn a competitive market, firms can freely enter or exit. If there is an opportunity to make __economic profits__ in a market, firms will enter, pushing down market prices and drive away profits. Note that making profits does not imply making economic profits. Economic profits take into account the opportunity cost of the firm. For instance, if leaving money in a bank earns an interest of 5% per month and the firm is generating less than 5% return on investment, it is not making economic profits even though it is making profits. A long-run equilibrium is reached when the following conditions are satisfied:\n\n1. Every firm is __maximizing profits__: $p=MC(q)$\n2. Each firm makes __zero economic profits__: $p=AC(q)$. This means that firms make the same profits in other competitive markets (hence no incentives for other firms to enter or for existing firms to exit)\n3. The market clears: market demand equal to LR market supply at the equilibrium price\n\nHence in a LR equilibrium, firms are doing the best they can do in the market which they have no incentives to leave and no other firms have incentives to enter because of zero economic profits, and the price is such that supply is equal to demand. \n\n::: {exm-LRPartialEQM}\nConsider a perfectly competitive industry populated by identical firms with the cost function $C(q)=10 - 5q + 2q^2$. We would like to determine the long-run equilibrium of the market as well as the equilibrium number of firms operating in it.[^1]\n\n[^1]: Note that we are given a short-run cost function, which has a fixed cost, but we would like to determine the market equilibrium in the long run.\n\nDenote the LR equilibrium quantity, price and market size $q^*$, $p^*$ and $N^*,$ respectively.\n\n* Since each firm in the market sets $MC(q_i^*) = AC(q_i^*)$:\n    $$\n    \\begin{aligned}\n    -5 + 4 q^*_i &= \\frac{10}{q_i^*} - 5 + 2 q_i^* \\\\\n    q_i^* &= \\sqrt{5} \\approx 2.24.\n    \\end{aligned}\n    $$\n    \n* Since $MC(q_i^*) = p^*$, we can deduce the LR equilibrium market price:\n    $$ \n    p^* = -5 + 4 q^*_i = -5 + 4 \\sqrt{5} \\approx 3.94 \n    $$\n    \n* Equilibirum quantity can be found using the market demand equation:\n    $$ \n    q^* = 100 - 2p^* \\approx 92.11 \n    $$\n    \n* The number of active firms in the LR:\n    $$ \n    N^* = \\frac{q^*}{q_i^*} \\approx 41.19 \n    $$\n\n* Hence in the LR equilibrium, the price will be about $\\$3.94$ per unit. At this price about $92$ units will be produced by about $41$ firms.[^2]\n\n:::\n\n# General equilibrium in a pure exchange economy\n\nThe partial equlibrium we consider above concerns a single market. In a general equilibrium analysis, we examine all markets at the same time, taking into account the interconnectedness among different markets. We shall restrict our attention to the case of an exchange economy with two consumers and two consumption goods. Each individual has an initial endowment and they can trade with one another if they wish. \n\nA list or a vector of __endowments__ keeps track of the amount of each good each consumer can enjoy when they do not trade:\n$$ \ne \\equiv (e_1^A, e_2^A;e_1^B, e_2^B).\n$$\n\nThe Edgeworth box is a useful tool to represent an exchange economy with two consumers and two goods. The width and length of the box represent the total endowment of each good.\n\n::: {#fig-EWbox fig-cap=\"An Edgeworth box with two goods and two consumers\nin a pure exchange economy. The total endownment of each good is 10 units. At the intial endowment, agent A has 2 units of $x_1$ and 8 units of $x_2$ whereas agent B has 8 units of $x_1$ and 2 units of $x_2$.\"}\n```{python}\nmm.plotEWBox()\n```\n:::\n\nAn __allocation__ lists the amount of each good that each consumer consumes:\n$$ \nx \\equiv (x_1^A, x_2^A, x_1^B, x_2^B). \n$$\n    \nNote that $x$ can be different from $e$ with trade. An allocation is __feasible__ if the total demand/allocation of each good does not exceed its total supply/endowment. In an economy of $N$ consumers and $L$ goods, this means:\n$$ \n\\begin{aligned}\n\\sum_{i=1}^N x^i_j \\leq \\sum_{i=1}^N e^i_j,\\quad  j=1,\\dots,L.\n\\end{aligned}\n$$\n\nIn our case of interest $i\\in\\{A, B\\}$ and $L=2.$\nObserve that any point inside or on the side of the Edgeworth box is feasible.\n\n::: {#def-GE}\n## General equilibrium in an exchange economy\n\nWe say that a price vector $p\\in\\mathbb{R^L_{++}}$ and an allocation $x\\in\\mathbb{R^L_{+}}$ constitute a competitive general equilibrium in an exchange economy if:\n\n1. The allocation $x$ is feasible\n2. Given prices, $x$ solves the UMP of every consumer\n3. The equilibrium price $p$ clears all markets. This means that the aggregate demand is equal to aggregate supply for each good:\n    $$ \n    q_j^D(p_j) = q_j^S(p_j),\\quad \\forall j=1,\\dots,L. \n    $$\n    In the case of a pure exchange economy, aggregate supply is equal to total endowment\n:::\n\nRecall that for each consumer that has an interior solultion to their UMP, the marginal utility per dollar is equalized across the goods. Mathematically, this condition was:\n\n$$\n    \\frac{U^i_k(x^*)}{p_k} = \\frac{U^i_l(x^*)}{p_l},\n$${#eq-EQMfoc1}\n\nwhere $U^i_k(x^*)$ denotes the partial derivative of $U^i$, the utility function of consumer $i$ with respect to good $k$, evaluated at the optimal consumption bundle $x^{*}$ of this person, and $p_k$ is the price of good $k$. This condition must hold for all goods $k,l=1,\\dots,L$ and for every individual $i=1,\\dots,N$. Observe that @eq-EQMfoc1 is equivalent to:\n\n$$\n% \\begin{aligned}\n    % \\frac{U^i_k(x^*)}{U^i_l(x^*)} &= \\frac{p_k}{p_l} \\\\\n    MRS^i_{k,l}(x^*) = \\frac{p_k}{p_l}, \\quad\\forall i=1,\\dots,N.\n% \\end{aligned}\n$${#eq-EQMfoc2}\n\nHence in equilibrium, the MRS is equal to the price ratio for each individual. This condition together with binding budget constraints will give us the optimal allocation as a function of prices (or more precisely price ratios), which can in turn be determined by the market clearning conditions.  Let us look at an example.\n\n\n::: {#exm-EQM-exchange-eco}\nConsider two consumers with identical preferences represented by a Cobb-Douglas utility function:\n$$\nu(x_1, x_2) = x_1 x_2.\n$$\nTheir initial endowment is:\n\n$$\n\\begin{eqnarray}\ne^A &=& (100, 350) \\\\\ne^B &=& (100, 50)\n\\end{eqnarray}\n$$\nIn autarky each individual can always consumer their endowments. The question is, can they do better with trade? If yes, how much (the allocation), and at which terms (the price ratio)? Let us first solve each individual's UMP, which is:\n$$\n\\begin{aligned}\n&\\max_{x^i} u(x^i) = x_1^i x_2^i,\\\\\n&\\text{s.t. } px^i \\leq pe^i,\\quad i=A,B.\n\\end{aligned}\n$$\nIn optimality:\n$$\nMRS^i_{1,2} = \\frac{p_1}{p_2} \\iff p_1x_1^i = p_2x_2^i.\n$${#eq-FOCexm}\nThe budget constraints bind, implying:\n$$\n\\begin{aligned}\npx^i &= pe^i \\\\\n\\end{aligned}\n$${#eq-BC}\n@eq-FOCexm and @eq-BC provide a system of two equations in two unknowns for each consumer. Solving this system yields:\n$$\n\\begin{aligned}\nx_1^i &= \\frac{pe^i}{2p_1}, \\quad i=A,B \\\\\nx_2^i &= \\frac{pe^i}{2p_2}, \\quad i=A,B. \\\\\n\\end{aligned}\n$${#eq-OptAll}\nIn order to solve for the price ratio, we only need to consider the market clearing condition for $L-1$ markets, which is just a single market in this example. Let us consider this condition for the market of $x_1$:\n$$\n\\begin{aligned}\nx_1^A + x_1^B &= e_1^A + e_1^B \\\\\n\\frac{pe^A + pe^B}{2p_1} &= e_1^A + e_1^B \\\\\np_2(e^A_2 + e^B_2) &= p_1(e_1^A + e_1^B)\n\\end{aligned}\n$$\n\n$$\n\\frac{p_2}{p_1} = \\frac{e_1^A + e_1^B}{e_2^A + e_2^B}.\n$${#eq-OptPrice}\nSubstituting the specific values of endownments into @eq-OptAll and @eq-OptPrice, we obtain the equilibrium allocation and price ratio. In particular:\n\n$$\n\\begin{aligned}\n(x_1^A, x_2^A) &= (137.5,275), \\\\\n(x_1^B, x_2^B) &= (62.5,125), \\\\\n\\frac{p_2}{p_1} &=\\frac{1}{2}.\n\\end{aligned}\n$$\n\nObserve that in equilibrium, the first good is twice as valuable as the first one. This is no coincidence: each consumer extracts the same utility from each good, and yet the second one is twice as abundant as the first.\n:::\n\n\n::: {#rem-RemQM} \nNote that in a market of $L$ goods, one good is chosen as a numeraire and the price ratios give us the prices of the other goods in the units of the numeraire. In a sense, this gives us the _real_ prices of goods, which, rather than _nominal_ prices, matter for optimal allocation. One can verify this intuition quickly by imagining a situation when prices double for all goods (i.e., water raises all boats by the same proportion): the nominal value of wealth doubles, but so does the cost of consumption, hence the optimal allocation should not be modified.\n:::\n\n# Welfare theorems\n\nThe equilibrium we have found in the previous section is called a competitive equilibrium. It is _competitive_ in the sense that each person does what is in the best interest and the markets clear at the equilibrium prices. This is also referred to as a decentralized equilibrium because it is not the result of some benevolent central authority allocating aggregate resources in a way that they judge best. \n\nEconomic decisions are all about efficient allocation of resources. Economic problems exist because resources are scarce. A natural question arises, then, is the __competitive equilibrium allocation (CEA)__ obtained by each one acting in their best interest, efficient?\n\nIn economics, the notion of efficiency of interest is Pareto efficiency. We say that an allocation is __Pareto efficient__ if there exists no other allocation that is strictly better off for someone without being worse off for someone else. In other words, an efficient allocation is one that cannot be improved for someone without hurting someone else. In a market with no market failures, it can be shown that under mild conditions, a CEA is Pareto efficient. This is the first welfare theorem (FWT). Graphically, the Pareto efficient allocation lies at the tangency of any two ICs in the Edgeworth box. This means that such allocations are not unique, and in fact the locus of all __Pareto efficient allocations (PEA)__ forms the so-called __contract curve__. How come we found only one of them in the previous example? This is because which Pareto efficient allocation can be achieved by market forces alone depends on the initial endowment. If we want to alter the outcome, we need to modify the starting point. This is the idea behind the second welfare theorem (SWT).\n\nAnother natural question that one might ask is why would an economy prefer a different Pareto efficient allocation? Why bother redistributing resources to incentivise the market to achieve a different allocation at all? It is because on top of efficiency, societies also care about equality. If one starts out with abundant resources, then market forces alone tend to lead to an efficient allocation that gives more to the haves and less to the have-nots. \n\nTo sum up, the FWT tells us that when there are no market failures, the CEA is Pareto efficient. The SWT says that any Pareto efficient, i.e., any point on the contract curve, can be obtained by redistributing initial resources and then letting the market work (again under some conditions). Let us state these important results formally.\n\n::: {#thm-FWT}\n## First welfare theorem\nEvery competitive equilibrium allocation is Pareto efficient.\n:::\n\n::: {#thm-SWT}\n## Second welfare theorem\nConsider an a efficient allocation $\\bar{x}$ and a _redistribution_ of the initial endowment from $e$ to $\\bar{e}$ such that $p\\bar{e}^i = p\\bar{x}^i$ for every individual $i=A, B$. Then every efficient allocation can be supported by a competitive equilibrium allocation.\n:::\n\nLet us illustrate the SWT by continuing with @exm-EQM-exchange-eco. The condition for an allocation to be a CEA was:\n$$\n\\begin{eqnarray}\nMRS_{1,2}^A(x^A) &=& MRS_{1,2}^B(x^B) = \\frac{p_1}{p_2} \\\\\n\\frac{x_2^A}{x_1^A} &=& \\frac{x_2^B}{x_1^B} = \\frac{1}{2}.\n\\end{eqnarray}\n$$\nHence any allocation satisfying $x_2^i = 2 x_1^i$ is a CEA, which is also a PEA by the FWT. Given the initial endowment, we have obtained for this example:\n\n$$\n\\begin{aligned}\n(x_1^A, x_2^A) &= (137.5,275), \\\\\n(x_1^B, x_2^B) &= (62.5,125).\n\\end{aligned}\n$$\n    \nBut this is not the only PEA. For example, another PEA satisfying $x_2^i = 2 x_1^i$ is \n$$\n\\bar{x}^i \\equiv (x_1^i, x_2^i) = (100, 200), \\quad i=A,B.\n$$\nCan this this PEA emerge as a CEA? The SWT tells us yes. According to the SWT, we need to modify the initial endowments in such a way that the budget constraint still binds for each consumer:\n$$\n\\begin{aligned}\np\\bar{x}^i &= p\\bar{e}^i \\\\\np_1 \\bar{x}_1^i + p_2 \\bar{x}_2^i &= p_1 \\bar{e}_1^i + p_2 \\bar{e}_2^i \\\\\n\\bar{x}_1^i + \\frac{p_2}{p_1} \\bar{x}_2^i &= \\bar{e}_1^i + \\frac{p_2}{p_1} \\bar{e}_2^i\n\\end{aligned}\n$$\n\n$$\n\\therefore \\bar{x}_1^i + 2\\bar{x}_2^i = \\bar{e}_1^i + 2\\bar{e}_2^i.\n$${#eq-temp}\n\nSubstituting the values of the new PEA into @eq-temp for each consumer, we obtain two equations in four unknowns $\\bar{e}_1^A, \\bar{e}_2^A, \\bar{e}_1^B, \\bar{e}_2^B$. We need two other equations to solve for these unknowns; they come from the market clearing conditions. Putting all this together, we obtain the following system:\n$$\n\\begin{aligned}\n\\bar{x}_1^A + 2\\bar{x}_2^A &= \\bar{e}_1^A + 2\\bar{e}_2^A, \\\\\n\\bar{x}_1^B + 2\\bar{x}_2^B &= \\bar{e}_1^B + 2\\bar{e}_2^B, \\\\\n\\bar{x}_1^A + \\bar{x}_1^B &= \\bar{e}_1^A + \\bar{e}_1^B, \\\\\n\\bar{x}_2^A + \\bar{x}_2^B &= \\bar{e}_2^A + \\bar{e}_2^B.\n\\end{aligned}\n$$\n    \nNote that only three of the four equations from the system above are linearly independent (one degree of freedom), implying that solutions are not unique.\nOne immediate solution is $\\bar{e} = \\bar{x}$. In other words, if we give each individual a PEA, they will stick to it.\nObserve that\n$$\n\\begin{aligned}\ne &= (100, 350, 100, 50) \\\\\n\\bar{e} &= (100, 200, 100, 200).\n\\end{aligned}\n$$\nThus one way to redistribute is to tax $A$ an amount equivalent to 150 units of the first good and give them to $B$. \n\n\n# General equilibrium with production\n\n## Adding production to the economy\n\nIn a production economy, consumers own factors of production, which they can rent out to firms to earn income. Firms choose the quantity of factors of production to maximize profit, taking as given the prices (of factors and final consumption goods). Consumers choose the quantity of consumption goods to maximize utility, taking as given prices (of factors and final consumption goods). \nIn equilibrium, aggregate demand is equal to aggregate supply in each market, including markets of production factors.\n    \nConsider an economy two consumers with Cobb-Douglas utility function\n$$\nu(x_1^i, x_2^i) = x_1^i x_2^i\n$$ \nfor each consumer $i=A, B$ whose endowments are:\n$$\n\\begin{aligned}\ne^A &= (k^A, l^A), \\\\\ne^B &= (k^B, l^B).\n\\end{aligned}\n$${#eq-endowment}\n    \nSuppose there are two firms in the economy, each producing one of the consumption goods according to a Cobb-Douglas technology:\n$$\n\\begin{aligned}\ny_1 = F^1(K_1, L_1) &= K_1^a L_1^b, \\\\\ny_2 = F^2(K_2, L_2) &= K_2^b L_2^a,\n\\end{aligned}\n$$\nwhere $a+b=1$ and $a, b \\in (0,1)$.\n    \nAn allocation $(x_1^A, x_1^B, x_2^A, x_2^B, K_1, L_1, K_2, L_2)$ and a price vector $p=(p_1, p_2, w, r)$ constitute a competive equilibrium (or Walrasian equilibrium) of the production economy if:\n\n1. Given prices, $(x_1^i, x_2^i)$ solves the UMP for each consumer $i\\in\\{A,B\\}.$\n\n2. Given prices, $(K_j, L_j)$ solves the PMP for each firm $j\\in \\{1,2\\}.$\n\n3. Prices are such that markets clear:\n    $$\n    \\begin{aligned}\n    \\text{Consumption goods:   }\\sum_i x^i_j &= y_j \\equiv F^j(K_j, L_j), \\quad \\forall j=1,2, \\\\\n    \\text{Capital good:   }\\sum_j K_j &= k^A + k^B, \\\\\n    \\text{Labor good:   }\\sum_j L_j &= l^A + l^B.\n    \\end{aligned}\n    $$\nIn other words, we are in an equilibrium if ever agent optimizes and markets clear. Let us first consider the consumers, who face the UMP.\n\n## UMP\n\nConsumer $i$ solves:\n$$\n\\begin{aligned}\n&\\max_{x^i} u(x^i) \\\\\n&\\text{s.t. } px^i \\leq wl^i + rk^i.\n\\end{aligned}\n$${#eq-UMP}\n\nObserve that since consumers own labor and capital, their income come from renting out these factors of production.\nThe FONC yields:\n$$\nu'_j(x^i) = \\lambda_i p_j, \\quad\\forall j=1,2.\n$${#eq-FOC_UMP}\n\nSince $u'_j>0$ we must have $\\lambda > 0$ in optimality, implying that the BC binds:\n$$\npx^i = wl^i + rk^i.\n$$\n    \nMoreover:\n$$\nMRS_{1,2}^i = \\frac{p_1}{p_2},\\quad \\forall i\\in\\{A,B\\}.\n$${#eq-MRS_i}\n    \n@eq-MRS_i implies:\n    \n$$\n\\frac{x^i_2}{x^i_1} = \\frac{p_1}{p_2} \\quad \\forall i, \n$$\n    \nwhich together with the binding BC provide the optimal consumption bundle for each consumer as function of factor prices and endowments. In particular:\n    \n$$\nx_j^i = \\frac{wl^i + rk^i}{2p_j},\\quad i\\in\\{A, B\\},\\quad j\\in\\{1, 2\\}.\n$${#eq-demand_conso}\n  \nDenote the total endowment $l=\\sum_i l^i$ and $k= \\sum_i k^i.$\nBy the market clearing condition for good 1: \n$$\n\\begin{aligned}\nx_1^A + x_1^B &= y_1 = F^1(K_1, L_1) = K_1^a L_1^b \\\\\n\\frac{wl + rk}{2p_1} &= K_1^a L_1^b.\n\\end{aligned}\n$${#eq-MC_x1}\n    \nLikewise for the second good:\n$$\n\\frac{wl + rk}{2p_2} = K_2^b L_2^a.\n$${#eq-MC_x2}\n    \nDividing @eq-MC_x2 by @eq-MC_x1 side by side yields:\n$$\n\\frac{p_1}{p_2} = \\frac{K_2^b L_2^a}{K_1^a L_1^b}.\n$${#eq-prices_UMP}\n\nNext we consider firms, who seek to maximize profits.\n\n## PMP\n\nEach firm $j=1,2$ solves their profit maximization problem (PMP):\n    \n$$\n\\max_{K_j, L_j} \\pi_j = p_j F^j(K_j, L_j) - rK_j - wL_j.\n$${#eq-PMPj}\n    \nIn optimality:\n$$\np_j F_K^j = r, \\quad p_j F_L^j = w.\n$${#eq-PMPj_FOC}\n\nHence: \n$$\n\\begin{aligned}\n\\frac{p_1}{p_2} &= \\frac{F_K^2}{F_K^1} = \\frac{F_L^2}{F_L^1} \\\\\n\\frac{p_1}{p_2}&= MRT_{1,2}^K = MRT_{1,2}^L.\n\\end{aligned}\n$${#eq-prices_PMP}\n\nThe $MRT^K_{1,2}$ is the rate at which the economy transforms the second good into the first good using capital. Observe that @eq-MRS_i and @eq-prices_PMP together say that at an optimum, the economy transforms one good for the other at the rate consumers are willing to substitute one for the other. From @eq-prices_UMP and @eq-prices_PMP and the fact that $a+b=1,$ we have:\n$$\n\\begin{aligned}\n\\frac{p_1}{p_2} = \\frac{F_K^2}{F_K^1} &= \\frac{K_2^b L_2^a}{K_1^a L_1^b} \\\\\n\\frac{b K_2^{b-1} L_2^a}{a K_1^{a-1} L_1^b} &= \\frac{K_2^b L_2^a}{K_1^a L_1^b} \\\\\n\\implies \\frac{K_2}{K_1} &= \\frac{b}{a}.\n\\end{aligned}\n$${#eq-rels_K}\n\nWe will now solve for the CEA of this economy using the market clearing conditions.\n\n## The CEA\n\nCombining @eq-rels_K and the market clearing condition for the capital market $K_1 + K_2 = k,$ we can solve for the optimal values of capital. In particular,\n\n$$\nK_1 = a k, \\quad K_2 = b k.\n$${#eq-allo_K}\n\nFrom @eq-prices_UMP and @eq-prices_PMP and the fact that $a+b=1,$ we have:\n$$\n\\frac{L_2}{L_1} = \\frac{a}{b}.\n$${#eq-rels_L}\n\nAgain, combining @eq-rels_L and the market clearing condition for the labor market $L_1 + L_2 = l,$ we obtain:\n    \n$$\nL_1 = a l, \\quad L_2 = bl.\n$${#eq-allo_L}\n\nHaving computed factor demands, we can substitute these values into @eq-prices_UMP to determine equilibrium price ratio $p_1/p_2$. We can then normalize $p_2\\equiv 1,$ to obtain:\n$$\np_1 = \\frac{b}{a}\\left(\\frac{k}{l}\\right)^{b-a}.\n$${#eq-price_x1}\n    \nFactor prices can then be determined from @eq-PMPj_FOC. The equilibrium allocations $x^A, x^B$ can be determined by substituting factor and consumption prices into @eq-demand_conso.\n\n# The social planner's problem (SPP)\n\nIn a centralized economy, the benevolent social planner allocates resources in such a way that maximizes a social welfare function (weighted sum of utilities) subject to some feasibility constraints. A solution to the social planner's problem is Pareto efficient. \n\n## The SPP in a pure-exchange economy\nMathematically, the social planner solves:\n$$\n\\begin{aligned}\n&\\max_{(x^i)_{i\\in I}} \\sum_{i\\in I} w^i u^i(x^i) \\\\\n&\\text{s.t. } \\sum_{i\\in I} x^i_j \\leq \\sum_{i\\in I} e^i_j, \\quad \\forall j\\in J,\n\\end{aligned}\n$${#eq-SPP_exchange}\n\nwhere $w_i$ are social welfare weights. Note that there are no prices in the social planner's problem (SPP), why is that? In a decentralized economy, selfish interest and prices guide individuals to efficient decisions. In a centralized economy, the social planner knows what is best and does not need prices as signals to allocate resources efficiently. \n\n## The PEA in a pure exchange economy\n\nThe KKT conditions for the SPP's problem:\n$$\n\\begin{aligned}\n    w^i u^i_j(x^i) &= \\lambda_j, \\quad \\forall j\\in J, \\: i\\in I, \\\\\n    \\sum_{i\\in I} x^i_j &= \\sum_{i\\in I} e^i_j, \\quad \\forall j\\in J.\n\\end{aligned}\n$$\n\nConsumers have identical preferences. Hence:\n$$\n\\begin{aligned}\nw^A u^A_j(x^A) &= w^B u^B_j(x^B) = \\lambda_j\\\\\nw^A x_j^A &= w^B x_j^B, \\\\\n\\implies \\frac{x_j^A}{x_j^B} &= \\frac{w^A}{w^B}, \\quad j=1,2.\n\\end{aligned}\n$$\n\nThis together with the binding feasibility constraints characterize the PEA for this economy:\n    \n$$\nx^A = w^A e, \\quad x^B = w^B e.\n$$\n    \nThus in a pure exchange economy the PEA is proportional to the social weight of the individual. If the social weights are equal, the aggregate endowments will be divided equally among the consumers. In general the results will be different if social weights are different or preferences are different among consumers.\n    \n## The SPP in a production economy\n\nAccording to the FWT the CEA in the production economy also Pareto efficient. Let us show that the CEA is also a PEA, i.e., that the FWT is verified in this production economy.\nA PEA consists of a vector of consumption goods and factors of production $(x_i)_{i\\in I}, (K_j, L_j)_{j=J}$ that maximizes aggregate welfare subject to feasibility constraints.\n\n## The PEA in a production economy\n\nThe social planner's problem for a production economy reads:\n\n$$\n\\begin{aligned}\n&\\max_{(x^i)_{i\\in I}, (K_j, L_j)_{j\\in J}} \\sum_{i\\in I} w^i u^i(x^i) \\\\\n\\text{s.t. }&\\begin{cases}\n                \\sum_{i\\in I} x^i_j \\leq F(K_j, L_j) \\:\\forall j \\\\\n                \\sum_{j\\in J} K_j \\leq \\sum_i k^i \\equiv k \\\\\n                \\sum_{j\\in J} L_j \\leq \\sum_i l^i \\equiv l\n\\end{cases}\n\\end{aligned}\n$${#eq-SPP}\n\nwhere $w_i$ are social welfare weights.\n\n::: {#rem-SPPProdEco}\nObserve that the first constraint in the SPP is the feasibility constraint on each consumption good.\nThe last two constraints are feasibility constraints on the factors of production.\n:::\n\nTo solve the SPP, we first set up the Lagrangian:\n\n$$\n\\begin{aligned}\n\\mathcal{L} &= \\sum_{i\\in I} w^i u^i(x^i) \\\\\n&+ \\sum_{j\\in J} \\lambda_j\\left[F(K_j, L_j) - \\sum_{i\\in I}x^i_j\\right] \\\\\n&+ \\mu_K (k - \\sum_{j\\in J} K_j) \\\\\n&+ \\mu_L (l - \\sum_{j\\in J} L_j).\n\\end{aligned}\n$${#eq-SPP_Lang}\n    \nThe FOCs yield:\n\n$$\n\\begin{aligned}\n    \\frac{\\partial \\mathcal{L}}{\\partial x^i_j} &= 0 \\iff w^i u^i_j(x^i) = \\lambda_j, \\quad \\forall j\\in J, \\: i\\in I, \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial K_j} &= 0 \\iff \\lambda_j MPK_j = \\mu_K, \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial L_j} &= 0 \\iff \\lambda_j MPL_j = \\mu_L. \n\\end{aligned}\n$$\n\nObserve that $\\lambda_j>0$ for all good $j$ and $\\mu_K>0$, $\\mu_L>0$, implying that the feasibility constraints bind at a PEA. \nFrom the FOC w.r.t to the consumption good we obtain:\n$$\nMRS^A_{1,2}(x^A) = MRS^B_{1,2}(x^B).\n$${#eq-SPP_FOC}\n    \nFrom the FOC w.r.t to factors:\n    \n$$\n\\begin{aligned}\n    \\lambda_1 MPK_1 = \\lambda_2 MPK_2 \\iff \\frac{\\lambda_1}{\\lambda_2} &= MRT^K_{1,2} \\\\\n    \\lambda_1 MPL_1 = \\lambda_2 MPL_2 \\iff \\frac{\\lambda_1}{\\lambda_2} &= MRT^L_{1,2} \\\\\n    \\frac{MPK_1}{MPL_1} = \\frac{MPK_2}{MPL_2} \\iff MRTS^1_{K,L} &= MRTS^2_{K,L}.\n\\end{aligned}\n$$\n\nThese conditions being satisfied by the CEA, implying that the CEA is also a PEA.\n\n\n# Exercises\n\n::: {#exr-SRSupply}\n\nConsider a firm with the total cost function $C(q)=10−5q+2q^2$. Assume that this fixed cost is evenly distributed into sunk costs, $\\$5$, and non-sunk costs, $\\$5$. Show that the firm's SR supply curve is given by:\n\n$$\nq(p) =\n\\begin{cases} p/4 + 5/4 & p > 4\\sqrt{2.5}-5\\approx 1.32 \\\\\n                     0 & \\mathrm{otherwise.}\n\\end{cases}\n$$\n\n\n<details>\n<summary>Answer</summary>\n\n* The nonsunk cost is $NSC(q) = 5 - 5q + 2q^2$\n\n* Effectively we maximize $pq - NSC(q)$ (we forget about the sunk costs), which is convex in $q$\n\n* FOC gives: $$p = MC(q) \\iff p = 4q - 5 \\iff q = (p+5)/4$$\n\n* Firm produces iff revenue covers nonsunk costs, i.e., if price is greater than ANSC. Shutdown point (crossing point between MC and ANCS): \n\n    $$\n    p = MC(q) = ANSC(q) = \\frac{5}{q}-5+2q \\\\\n    \\iff q=\\sqrt{2.5}\n    \\implies p = 4\\sqrt{2.5} - 5 \\approx 1.32.\n    $$ \n    \n    * Below $p=1.32$, the firm shuts down since it cannot recover nonsunk costs\n\n</details>\n:::\n\n\n::: {#exr-LRPEQM}\n\nConsider a perfectly competitive industry populated by identical firms with the cost function $C(q)=10 - 5q + 2q^2$. Suppose the market demand is given by $q^D(p) = 400 - 2p$.\nDetermine the long-run equilibrium price, quantity and the number of firms. \n\n<details>\n<summary>Answer</summary>\nSee @exr-LRPEQM. Observe the change in demand and equilibrium of the market.\n</details>\n:::\n\n::: {#exr-PEPOpt}\nConsider a two-person two-good economy with the following preferences:\n$$\n\\begin{align}\n    u_1(x_1, y_1) &= x_1y_1, \\\\\n    u_2(x_2, y_2) &= x_2y_2^2,\n\\end{align}\n$$\nwhere $x_i$ and $y_i$ the amounts of good $x$ and good $y$ that individual $i$ consumes, respectively. Suppose that the first person has an initial endowment of $40$ units of $x$ and $160$ units of $y$ while the second has $240$ units of $x$ and $120$ units of $y$. \n\n1. Represent this economy using and Edgeworth box.\n2. Define and compute the competitive equililibrium of this economy. Are the consumers better off with exchange (compared to eating their own endowments)?\n3. Define and solve the social planner's problem for this economy and determine the set of Pareto efficient allocations (the contract curve) of this economy. \n4. Does the first welfare theorem hold for this economy? \n:::\n\n\n\n\n    \n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"lecture_3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.56","theme":{"light":"lux","dark":"darkly"},"title":"Chapter 3. Equlibrium","toc-title":"Content","toc-location":"left"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}