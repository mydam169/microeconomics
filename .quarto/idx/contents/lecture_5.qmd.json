{"title":"Chapter 5. Game theory and imperfect competition","markdown":{"yaml":{"title":"Chapter 5. Game theory and imperfect competition","author":{"name":"My Dam","email":"my-thi-tra.dam@universite-paris-saclay.fr"},"number-sections":true,"execute":{"echo":false,"warning":false},"format":{"html":{"toc":true,"toc-depth":3,"toc-title":"Content","toc-location":"left"}}},"headingText":"from IPython.display import display","containsRefs":false,"markdown":"\n\n```{python}\n%load_ext autoreload\n%autoreload 2\n```\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport seaborn as sns\nimport pandas as pd\nimport dataframe_image as dfi\nimport ipywidgets as widgets\n# from ipywidgets import interact\nimport pandas as pd\n```\n\n```{python}\nimport sys\nimport os\nmod_dir = os.path.join(os.getcwd(), 'modules')\nif mod_dir not in sys.path:\n    sys.path.append(mod_dir)\n\nimport micro_modules as mm\nmm.load_viz_settings()\n```\n\n```{python}\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n```\n\n# A word on organization \n\nThis chapter contains a lot of definitions and concepts specific to game theory. In order to help quickly locate and link these concepts together, I have decided to put them all in @sec-concepts. Whenever you encounter a new concept throughout the chapter, you will most likely find its definition there. \n\n# Game theory basics\n\n## Game building blocks and examples\n\nIn order to define a game, we typically need at least four elements:\n\n* **Players**: who are playing the game (at least two)\n* **Rules**: what are the rules of the game, what _moves_ are possible and what are prohibited\n* **Outcomes**: what are the possible results of the games (score combinations leading to a win or a loss, scenario(s) of a draw, etc.)\n* **Payoffs**: the players' preferences over outcomes\n\nThe objective of each player in a game is to identify strategies that maximize potential payoffs, given what they know about the rules of the game, their opponents, the possible outcomes and their preferences. A __strategy__ is a complete contingent plan telling a player what action to take in every possible situation of the game.\n\nLet us illustrate these elements via a couple of examples.\n\n::: {#exm-matchingPennies}\n## Matching pennies\n\n* Players: There are two players A and B\n* Rules: Each player puts down a coin, either heads or tails up\n* Outcomes: Player A wins if the coins match (both heads or tails). Player B wins if the coins do not match.\n:::\n\n\n::: {#exm-tennis}\n\n## Tennis\n\nLet us consider a tennis game in a single tennis tournament (there are doubles and mixed doubles, too). A tennis match typically consists of up to seven sets, each of which consists of several games. We will be considering a single tennis game.\n\n* Players: two players of the same sex\n* Rules:\n  \n  * Scoring: A game is scored as 15, 30, 40 and game. If both players reach 40, it's called \"deuce.\" To win from deuce, a player must win two consecutive points (advantage and game).\n  * Service: One player serves in each game. The server must hit the ball diagonally into the opponent's service box. A serve that touches the net but lands in the correct box is a \"let\" and is replayed. A serve is a fault if it lands outside the service box or if the server misses the ball. Two consecutive faults result in a double fault, giving the point to the opponent.\n  * Rallies: After the serve, players rally by hitting the ball back and forth. The ball must be hit before it bounces twice on the player's side.\n  * Winning Points: A point is won if the opponent fails to return the ball within the court boundaries, hits it into the net, or touches the net after hitting the ball before the ball lands on the other side of the court, etc.\n* Results: A single winner by means of the scoring rule (no ties).\n:::\n\n## Assumption of common knowledge of rationality\n\nIn all games studied, we assume that players are rational. Each player knows every element of the game, namely, the players involved, the strategy in each contingency and the resulting payoff in each situation. In addition, every player knows that the other player(s) know all of this, including the fact that this player knows that they know. \n\n# Graphical representation of games\n\nThere are two ways to represent a game: by means of a matrix (normal form) or a game tree (extensive form). \n\n## Normal form\n\nThe normal form is the representation of a game using a matrix whose columns and rows represent all possible outcomes. It is best used to represent games of simultaneous moves where order of play is not important. \n\n### Pure strategy Nash equilibrium\n\nIn the examples that follow, the first number represents the payoff to the player whose strategies show up on each row of the matrix. The second number reprsents the payoff to the player whose strategies show up on each column.Let us try to determine the best responses and the Nash equilibrium  of each game. The NE that consists of a strategies that each player chooses with certainty is called __a pure strategy NE__. We will see that not all games have a pure strategy NE but if we allow players to choose certain strategies probablistically (as is often the case in sports), then a NE generally exists. This type of NE is called a __mixed strategy NE__.\n\n::: {#exm-pennies}\n::: {#fig-pmatch fig-cap=\"Normal form representation of the game of matching pennies. If pennies matched B pays A one dollar, otherwise A pays B one dollar.\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Heads</td>\n        <td>Tails</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Player B</th>\n        <td>Heads</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n    </tr>\n    <tr>\n        <td>Tails</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-crops}\nConsider this example from [CoreEcon](https://core-econ.org/the-economy/microeconomics/04-strategic-interactions-02-game-theory.html) which describes a strategic situation between two farmers who decide on which crop to grow. If both grow the same crop, they will flood the market with the same good and pushing down the price. The land of the person named Anil is equally suitable for both types of crops (cassava and rice). For the other person, Bala, the land is as good as that of Anil for growing rice, but less so for cassava. The outcome of this situation can be predicted using a simple game theory setupt.\n\n::: {#fig-crop fig-cap=\"An agricultural game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Bala</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Rice</td>\n        <td>Cassava</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Anil</th>\n        <td>Rice</td>\n        <td style=\"text-align:center\">(4,4)</td>\n        <td style=\"text-align:center\">(6,3)</td>\n    </tr>\n    <tr>\n        <td>Cassava</td>\n        <td style=\"text-align:center\">(6,6)</td>\n        <td style=\"text-align:center\">(5,2)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-auto}\nConsider a automobile market serviced by two firms, Ford and BMW. If both innovate (for example, introducing new EV models, incorporating AI, etc.), then they will share the market as before but earn lower profits due to the high R&D costs. If one innovates and the other does not, then the market share gained from the former will more than compensate for the high costs and it generates higher profits as a result. If both do not innovate, they continue to earn high profits.\n\n::: {#fig-duopoly fig-cap=\"A prisoners' dilemma game of innovation\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Vueling</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Innovate</td>\n        <td>Do not innovate</td>\n    </tr>\n    <tr>\n        <th rowspan=2>EasyJet</th>\n        <td>Innovate</td>\n        <td style=\"text-align:center\">(5,5)</td>\n        <td style=\"text-align:center\">(10,2)</td>\n    </tr>\n    <tr>\n        <td>Do not innovate</td>\n        <td style=\"text-align:center\">(2,10)</td>\n        <td style=\"text-align:center\">(7,7)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-dating}\nGame theory is very much alive in dating. In the simplest scenario, imagine two individuals (the _players_) deciding how much effort to put into the relationship. If both slack off, they split quickly and move on with no damage done. If one is committed while the other is lukewarm, the one committed ends up paying a higher price and potentially feeling resentful after the split. If both are committed (exerting high efforts), the relationship blossoms and they live happily ever after.[^1]\n\n[^1]: This is not the only dating theory so please don't get too carried away.\n\n::: {#fig-dating fig-cap=\"A dating game with multiple Nash equilibria\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Lover A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Commit</td>\n        <td>Slack off</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Lover B</th>\n        <td>Commit</td>\n        <td style=\"text-align:center\">(7,7)</td>\n        <td style=\"text-align:center\">(-2,5)</td>\n    </tr>\n    <tr>\n        <td>Slack off</td>\n        <td style=\"text-align:center\">(5,-2)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n    </tr>\n</table>\n:::\n:::\n\nWhat are the differences in the outcomes of these games? Observe that the game of matching pennies in @exm-pennies does not have an equilibrium. There is always an incentive to deviate from a chosen strategy depending on the choice of the opponent. In @exm-crops, we have a unique Nash equilibrium that is also Pareto optimal.[^2] In @exm-auto, we have a unique Nash equilibrium which is not Pareto optimal: the pursuit of individual interest does not lead to a socially optimal outcome. This is an example of the famous Prisoners' Dilemma game. In @exm-dating, we see a situation of non-uniqueness of equilibria. \n\n[^2]: An allocation is called Pareto optimal if there exists no other feasible allocations that strictly improve the payoff of at least one individual without sacrificing the payoff of another.\n\n### Mixed strategy Nash equilibrium\n\nLet us return to @exm-pennies to illustrate mixed strategy NE. Suppose that B chooses H with probability $p$ and T with probability $1-p,$ and A chooses H with probability $q$ and T with probability $1-q.$ The modified pennies matching game can be rerpresented as in @fig-penniesMixedStrategy.\n\n::: {#fig-penniesMixedStrategy fig-cap=\"A mixed strategy matching pennies game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <td>$q$</td>\n        <td>$1-q$</td>        \n    </tr>\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <td>Heads</td>\n        <td>Tails</td>        \n    </tr>\n    <tr>\n        <th rowspan=2 style=\"text-align:center\">Player B</th>\n        <td>$p$</td>\n        <td>Heads</td>\n        <td>(-1,1)</td>\n        <td>(1,-1)</td>        \n    </tr>\n    <tr>\n        <td>$1-p$</td>\n        <td>Tails</td>\n        <td>(1,-1)</td>\n        <td>(-1,1)</td>        \n    </tr>\n</table>\n:::\n\nFor each player, one strategy is preferred to the other iff it generates a higher _expected payoff_. For A, the expected payoff from playing Heads is:\n\n$$\n    \\mathbb{E}^A_H[X] = p \\times 1 + (1 - p) \\times (-1) = 2p - 1.\n$$\n\nAnd from playing Tails is:\n\n$$\n    \\mathbb{E}^A_T[X] = p \\times (-1) + (1 - p) \\times 1 = 1 - 2p.\n$$\n\nHence A strictly prefers Heads to Tails if and only if\n\n$$\n\\mathbb{E}^A_H[X] \\gt \\mathbb{E}^A_T[X] \\iff p > \\frac{1}{2}.\n$$\n\nHence the best response of $A$ could be written as:\n$$\nq(p) = \\begin{cases}\n    1 & p > 0.5 \\\\\n    \\in [0,1] & p = 0.5 \\\\\n    0 & p < 0.5.\n\\end{cases}\n$${#eq-BRA-ms}\n\nLikewise for B:\n\n$$\n\\begin{aligned}\n\\mathbb{E}^B_H[X] &\\gt \\mathbb{E}^B_T[X] \\\\\n1 - 2q &\\gt 2q - 1 \\\\\nq &< \\frac{1}{2}\n\\end{aligned}\n$$\n\nThe best response of $B$ is thus:\n\n$$\np(q) = \\begin{cases}\n    1 & q < 0.5 \\\\\n    \\in [0,1] & q = 0.5 \\\\\n    0 & q > 0.5\n\\end{cases}\n$${#eq-BRB-ms}\n\nThe msNE is at the intersection of the two best response curves (red dot in @fig-msNE), which is when both probabilities are equal to one-half:\n\n$$\n    \\mathrm{msNE}(q, p) = (0.5, 0.5).\n$${#eq-msNE-pennies}\n\n::: {#fig-msNE fig-cap=\"Best response functions and msNE in the pennies matching game\"}\n```{python}\nq = np.linspace(0, 1.5, 50)\n# BR of B\nplt.hlines(y=1, xmin=0, xmax=0.5, lw=2, color='k')\nplt.vlines(x=0.5, ymin=0, ymax=1, lw=2, color='k')\nplt.hlines(y=0, xmin=0.5, xmax=1, lw=2, color='k', label='BR of B: $p(q)$')\n\n# BR of A\nplt.vlines(x=0, ymin=0, ymax=0.5, lw=2)\nplt.hlines(y=0.5, xmin=0, xmax=1, lw=2)\nplt.vlines(x=1, ymin=0.5, ymax=1, lw=2, label='BR of A: $q(p)$')\n\n# msNE\nplt.scatter(.5, .5, color='r', s=75, label='msNE')\n\nplt.ylabel('$p$ (Probability of B playing H)', loc='top')\nplt.xlabel('$q$ (Probability of A playing H)', loc='right')\nplt.xlim([-.1, 1.5])\nplt.ylim([-.1, 1.5])\nplt.xticks(np.linspace(0, 1, 5))\nplt.yticks(np.linspace(0, 1, 5))\nplt.legend(loc='best')\nplt.grid(None)\nplt.show()\n```\n:::\n\nIf A and B are complete strangers then it is safe to assume that both play each strategy with the same probability (i.e., completely random). In this case, each player _randomizes_ and we have a mixed strategy Nash equilibrium (msNE). \nAfter a few rounds, they might know each other better and are able to _update_ the values of $q$ and $p$ accordingly and the game might end up with a pure strategy NE.\nIn highly competitive sports, sometimes many strong players lose to completely unknown ones, why might it be the case? One explanation is data availability. Matches of highly ranked players receive much wider media coverage. Their style of play, strengths and weaknesses are analyzed to excruciating details by experts, including the opponents and their coaches. Consequently, we have a player that is almost completely exposed while the other remains a wild card. The lack of information plays to the advantage of the relatively unknown player, typically causing difficulties to the opponent in the first few rallies or encounters. But if there is anything remarkable about top athletes, it is their ability to adapt, i.e., to _update_ their knowledge about the opponent's style and counterstrike effectively. The advantage due to initial ignorance wears out pretty rapidly if the unknown player does not have real strengths.\n\n\n## Extensive form \n\nThe extensive form of the game records not just the outcomes but also the dynamic of the game. For this reason, it is often used to represent sequential games in which the order of play is important. Indeed, taking out the game dynamic and collapsing it into a matrix typically results in too many equilibria, as we see in @fig-normFormExtGame. In particular, the normal form representation provies two equilibria: (In, Accommodate) and (Out, Price War). Nevertheless, if we examine the game in extensive form using backward induction (starting from the end nodes), it is clear that the best response of the incumbent (P2) to the entrant's \"In\" is to accommodate. Knowing this, the incumbent would choose to go in. Hence the only equilibrium of the game would be (In, Accommodate). The equilibrium (Out, Price War) is described as _sequentially irrational_ because it is not a NE in the subgame starting from the decision node of the incumbent. In dynamic games, we would like to rule out such irrational equilibria, hence the need for the more refined solution concept of __subgame-perfect equilibrium__(@def-SPE).\n\n::: {#fig-extForm fig-cap=\"An extensive form game with two players, P1 (entrant) and P2 (incumbent). The entrant moves first.\"}\n```{mermaid}\nflowchart LR\n   entrant{P1} --> |In| incumbent{P2} \n   entrant -- Out --> A(\"(0,10)\")\n   incumbent -- Accommodate --> B(\"(5,5)\")\n   incumbent -- Price war --> C(\"(-2,-2)\")\n\n   linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n   linkStyle 2 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-normFormExtGame fig-cap=\"Normal form representation of a sequential moves game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Potential entrant</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>In</td>\n        <td>Out</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Incumbent</th>\n        <td>Accommodate</td>\n        <td style=\"text-align:center\">(5,5)</td>\n        <td style=\"text-align:center\">(10,0)</td>\n    </tr>\n    <tr>\n        <td>Price war</td>\n        <td style=\"text-align:center\">(-2,-2)</td>\n        <td style=\"text-align:center\">(10,0)</td>\n    </tr>\n</table>\n:::\n\n## Backward induction and SPE\n\nIt is important to know how to identify and write an SPE. We solve for SPE using backward induction:\n\n  1. Start for the farthest end of the tree, focus on the decision point(s) of the last mover (the smallest subgames)\n  2. Identify her BR and shade the branch associated with her BR (i.e., the NE associated with each of these subgames)\n  3. Consider the second-to-last mover, identify her BR to the BR of the last mover, then shade this branch (another NE identified)\n  4. Repeat the previous step until we reach the first mover at the root node (the largest subgame is the entire game itself)\n\nThen we need to express the SPE as a strategy profile, which specifies the strategy for each player for every possible decision node where that player could be called to move, _even for nodes that are not reached_ in equilibrium.\n\n::: {#exm-SPE}\nConsider the following dynamic game with the first mover being Player 1 (P1). We would like to identify the SPE. For convenience I have put all the decision nodes in the diamond boxes.\n\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n    secondL -- A --> firstL{P1}\n    firstL -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    %% lower branch\n    first -- R --> secondR{P2}\n    secondR -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> firstR{P1}\n    firstR -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n```\n\nObserve that there are 5 subgames including the entire game itself. Let us use backward induction to solve for the NE in every subgame.\n\n::: {#fig-sgall fig-cap=\"Subgames\"}\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n\n    subgraph SG3\n        secondL -- A --> firstL{P1}\n        subgraph SG1\n            firstL -- V --> out2(\"(1,6)\")\n            firstL -- W --> out3(\"(4,5)\")\n            firstL -- X --> out4(\"(5,2)\")\n        end\n        secondL -- B --> out1(\"(7,1)\")\n        %% lower branch\n    end\n    \n    first -- R --> secondR{P2}\n    \n    subgraph SG4\n        secondR -- C --> out5(\"(2,7)\")\n        secondR -- D --> out6(\"(3,4)\")\n        secondR -- E --> firstR{P1}\n        subgraph SG2\n            firstR -- Y --> out7(\"(6,8)\")\n            firstR -- Z --> out8(\"(8,3)\")\n        end\n    end\n\n    style SG1 stroke:#0072c7,stroke-width:2px\n    style SG2 stroke:#4fe1d6,stroke-width:2px\n    style SG3 stroke:#db63d6,stroke-width:2px\n```\n:::\n\nWe now look for the NE in each subgame.\n\n::: {#fig-sg1 fig-cap=\"First subgame (SG1)\"}\n```{mermaid}\nflowchart LR\n    firstL{P1} -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    linkStyle 2 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg2 fig-cap=\"Second subgame (SG2)\"}\n```{mermaid}\nflowchart LR\n    firstR{P1} -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n    linkStyle 1 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg3 fig-cap=\"Third subgame (SG3)\"}\n```{mermaid}\nflowchart LR\n    secondL{P2} -- A --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg4 fig-cap=\"Fourth subgame (SG4)\"}\n```{mermaid}\nflowchart LR\n    secondR{P2} -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> out8(\"(8,3)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg5 fig-cap=\"Fifth subgame (root node)\"}\n```{mermaid}\nflowchart LR\n    first{P1} -- L --> out4(\"(5,2)\") \n    first -- R --> out5(\"(2,7)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\nFinally putting it all together, we can write the SPE as:\n$$\nSPE = \\{(L,\\: A/C, \\: X/Z\\}.\n$${#eq-SPE}\nRecall that we have to specify the strategy for each player for every possible decision node where that player could be called to move, _even for nodes that are not reached_ in equilibrium.\n\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n    secondL -- A --> firstL{P1}\n    firstL -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    %% lower branch\n    first -- R --> secondR{P2}\n    secondR -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> firstR{P1}\n    firstR -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n    linkStyle 0 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 4 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 7 stroke:#db63d6,stroke-width:4px,color:#000\n    linkStyle 11 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 1 stroke:#db63d6,stroke-width:4px,color:#000\n```\n:::\n\n\n# Key game concepts {#sec-concepts}\n\n::: {#def-strategy}\n## Strategy\nA strategy is a complete contingent plan specifying which action a player selects in every possible situation (contingency) she might face during a game.\n:::\n\n::: {#exm-stratey}\nIn the pennies matching game in @exm-matchingPennies, each player has two possible strategies: heads (H) or tails (T). We can write\n$S_A=S_B=\\{H, T\\}.$\n:::\n\n::: {#def-strategyProfile}\n## Strategy profile\nA strategy profile is a list describing the strategies that _each_ player selects. In a game of $N$ players, a strategy profile is $s=(s_1,s_2,\\dots,s_N)$. Equivalently we often write $s=(s_i,s_{-i})$ for any $i=1,\\dots,N.$ Here $s_{-i}$ means the strategies selected by players other than $i.$\n:::\n\n::: {#exm-stratProf}\nIn the pennies matching game, there are four possible strategy profiles:\n$$\ns \\in \\{(H,T), (T,H), (T,T), (H,H)\\}.\n$$\nHence a strategy profile is an element in the product space $S_A\\times S_B,$ or more generally an element in $S_i\\times S_{-i}$ for any $i=1,\\dots,N.$\n:::\n\n\n::: {#def-payoff}\n## Payoff function\nThe payoff function of a player $i$ is a mapping from a strategy profile to a real number $u_i : S_i \\times S_{-i} \\to \\mathbb{R}.$\n:::\n\nObserve that the payoff of a player typically depends on the strategies selected by the others. This is the _strategic_ property of games.\n\n::: {#def-weakDom}\n## Strategic dominance\nStrategy $s_i$ is a weakly dominant strategy of player $i$ if\n$$\nu_i(s_i, s_{-i}) \\geq u_i(s_j, s_{-i}),\n$${#eq-weak-dom}\nfor every $s_i \\neq s_j$ and $s_{-i}$ selected by the other players.\nIf the inequality sign in condition [-@eq-weak-dom] is strict, then $s_i$ is called a strictly dominant strategy. If the inequality sign reverses direction, then player $i$ views $s_i$ as a weakly dominated strategy (strictly dominated if the inequality sign is strict.)\n:::\n\n::: {#def-bestResponse}\n## Best response\nThe strategy $s_i$ of player $i$ is called the best response to her opponents' strategy profile $s_{-i}$ if:\n$$\nu_i(s_i, s_{-i}) \\geq u_i(s_j, s_{-i}), \\quad\\forall j\\neq i.\n$${#eq-BRdef}\nWe often write:\n$$\ns_i \\in BR_i(s_{-i}). \n$${#eq-BRcorr}\n:::\n\n::: {#rem-BRcorr}\nIn general, for each strategy profile $s_{-i},$ the best response coming from $i$ needs not be unique, i.e., the best response is a correspondence. When $BR_i(s_{-i})$ is a singleton for every possible $s_{-i},$ we have a best response function.\n:::\n\n::: {#rem-BRvsSdom}\nObserve that a dominant strategy is a best response, but not conversely. In order for a best response to be a dominant strategy, condition [-@eq-BRdef] has to hold for _every possible_ strategy profile selected by the other players. In other words, whatever the strategies selected by the other player(s), the best response remains the same for player $i.$ Strategic dominance is thus a much stronger than best response.\n:::\n\n::: {#def-NashEqm}\n## Nash equilibrium\nA strategy profile $s^*=(s^*_i, s^*_{-i})$ is a Nash equilibrium if every player plays their best reponse given their opponnents' strategies, that is:\n$$\ns^*_i \\in BR_i(s^*_{-i}),\\quad \\forall i=1,...,N.\n$${#eq-NE}\n:::\n\n::: {#def-infoSet}\n## Information set\nIn the context of extensive form games, an information set faced by a player is a set that connects all the nodes that the player cannot distinguish.\n:::\n\n::: {#def-subgame}\n## Subgame\nA subgame is a portion of an extensive-form game that contains a decision node and all subsequent nodes following it.\nGraphically, if we draw a circle around a subgame, then this circle cannot cross any information set: every subgame must contain all its information sets. The presence of information sets thus reduces the number of subgames.\n:::\n\n::: {#def-SPE}\n## Subgame-perfect equilibrium\nA strategy profile $(s_i^*, s^*_{-i})$ is a SPE if it specifies a Nash equilibrium in each subgame.\n:::\n\n# Applications to imperfect competition\n\n## Cournot model\n\nThe Cournot model is a simultaneous-moves game in which firms compete on quantity. Consider an industry with two firms (i.e., a douopoly) selling a homogeneous product. Each firm $i$ independently and simultaneously determines output $q_i$ to maximize profits, $i=\\{1, 2\\}.$\nThey each face a linear total cost $C_i(q_i) = cq_i$, $c>0.$\nLinear inverse demand curve: $p(q_1, q_2) = a - b\\left(\\sum_{i=1}^N q_i\\right)$ where $a, b>0.$ Notice that the production choice of each firm affects the market price of the good and consquently the bottom line of the other firm. This would not have been the case in a perfectly competitive market.\n\nEach firm $i$ solves its profit maximization problem to determine the optimal production level:\n$$\n\\begin{aligned}\n\\max_{q_i} \\pi_i &= R_i(q_i) - C_i(q_i) \\\\\n&= p(q_1, q_2)q_i - cq_i \\\\\n&= [a - b(q_1 + q_2)]q_i - cq_i\n\\end{aligned}\n$${#eq-PMP_cournot}\n    \nThe FOC yields:\n$$\n\\frac{\\partial \\pi_i}{\\partial q_i} = 0 \\iff a - 2bq_i - bq_j = c.\n$${#eq-FOC_cournot}\n    \nFrom @eq-FOC_cournot we can derive the best response (BR) function, which specifies the optimal output of each firm given the output choice of the other firm:\n\n$$ \nq_i = BR_i(q_j) = \\frac{a - c}{2b} - \\frac{q_j}{2}, \\quad i\\neq j.\n$${#eq-BR_cournot}\n    \nThe two best response functions specify the Nash equiblirium of the the game.\n$$\n\\begin{cases}\nq_1 &=  \\frac{a - c}{2b} - \\frac{q_2}{2} \\\\\nq_2 &=  \\frac{a - c}{2b} - \\frac{q_1}{2}. \n\\end{cases}\n$$\n\nSolving this system, we obtain the NE of the Cournot game:\n$$\n(q_1^*, q_2^*) = \\left(\\frac{a-c}{3b}, \\frac{a-c}{3b}\\right).\n$${#eq-NE-cournot}\n\nLet us try and visualize this outcome.\n\n::: {#fig-cournot-game fig-cap=\"Cournot competition on quantity in a duopoly\"}\n\n```{python}\na, b, c = 6, .75, 2\nqmax = (a - c) / b\nqstar = (a - c) / (3 * b)\nqmid = (a - c) / (2 * b)\nq = np.linspace(0, 7, 100)\nqCournot = (a - c) / (3 * b)\ndef BR1(q):\n    return (a - c) / (2 * b) - 0.5 * q\ndef BR2(q):\n    return (a - c) / b - 2 * q\ndef eqline(q):\n    return q\nplt.plot(q, BR1(q), label='$BR_2(q_1)$', color='k', lw=2)\nplt.plot(q, BR2(q), label='$BR_1(q_2)$', color='C0', lw=2)\nplt.plot(q[:65], eqline(q[:65]), linestyle=\"--\", color='gray', label=\"$q_1=q_2$\")\nplt.vlines(x=0, ymin=qmax*0.99, ymax=q.max(), color='C0', lw=4)\nplt.hlines(y=0, xmin=qmax*0.99, xmax=q.max(), color='k', lw=4)\nplt.scatter(qstar, qstar, color='r', s=70, label=\"Cournot NE\")\n\n# annotations\nplt.vlines(x=qstar, ymin=0, ymax=qstar, linestyle='--', lw=.5, color='k')\nplt.hlines(y=qstar, xmin=0, xmax=qstar, linestyle='--', lw=.5, color='k')\nplt.text(qstar*0.85, -.5, \"$\\\\frac{a-c}{3b}$\", fontsize=12)\nplt.text(qmid*0.95, -.5, \"$\\\\frac{a-c}{2b}$\", fontsize=12)\nplt.text(qmax*0.95, -.5, \"$\\\\frac{a-c}{b}$\", fontsize=12)\nplt.text(-0.75, qstar*0.9, \"$\\\\frac{a-c}{3b}$\", fontsize=12)\nplt.text(-0.75, qmid*0.95, \"$\\\\frac{a-c}{2b}$\", fontsize=12)\nplt.text(-0.75, qmax, \"$\\\\frac{a-c}{b}$\", fontsize=12)\n\n\nplt.xlabel(\"$q_1$\", loc='right')\nplt.ylabel(\"$q_2$\", loc='top')\nplt.ylim([0, q.max()])\nplt.xlim([0, q.max()])\nplt.xticks([])\nplt.yticks([])\nplt.legend(loc='best')\nplt.show()\n```\n:::\n\nFor completeness let us compute the equilibrium price of the duopoly, aggregate output and the profits earned by each firm.\n\n* Total output:\n    $$ \n    Q^C = q_1 + q_2 = 2q^C = \\frac{2(a - c)}{3b}. \n    $${#eq-totQ_cournot}\n    \n* Equlibrium price via the market demand curve:\n    $$ \n    p^C = a - bQ^C = \\frac{a + 2c}{3}. \n    $${#eq-price_cournot}\n    \n* Identical individual profits equal to:\n    $$ \n    \\pi^C = p^C q^C - cq^C = \\frac{(a - c)^2}{9b}.\n    $${#eq-profit_cournot}\n    \n\n\n## Stackelberg model\n\nConsider 2 firms with the same constant marginal cost $c$ as in the Cournot case. They also compete on quantity, but _sequentially_.\nTHe structure of the game is the following:\n\n  * First, firm 1 chooses $q_1$\n  * Then, having observed the choice of firm 1, firm 2 chooses $q_2$\n    \nThe first mover advantage can be due to legal barriers. For example, if firm 1 invents a new drug, it typically has a patent that gives exclusive rights to produce and sell it during the lifetime of the patent (up to 20 years for certain drugs).\n\nWe solve this game by backward induction, starting from firm 2, the follower.\n\n### PMP of the follower\n\nThe PMP of the follower (Firm 2):\n$$\n\\max_{q_2} [a - b(q_1 + q_2)]q_2 - cq_2.\n$$\n\nFOC w.r.t $q_2$ yields the BR function for Firm 2:\n$$ \nq_2(q_1) \\equiv BR_2(q_1) = \\frac{a - c}{2b} - \\frac{q_1}{2}.\n$${#eq-BR_stack}\n\nObserve that @eq-BR_stack coincides with @eq-BR_cournot since in both cases Firm 2 treats $q_1$ as exogenous\n\n### PMP of the leader\n\nFirm 1 chooses its own output to maximize profits:\n$$\n\\max_{q_1} [a - b(q_1 + BR_2(q_1))]q_1 - cq_1.\n$${#eq-PMP_stack_leader}\n\nIn @eq-PMP_stack_leader, Firm 1 anticipates that Firm 2 will be maximizing her profits, i.e., settig $q_2 = BR_2(q_1)$.\n\nThe FOC w.r.t $q_1$ yields the BR function for Firm 1:\n$$ \n\\frac{a - c - 2bq_1}{2} = 0\n\\iff q_1^S = \\frac{a-c}{2b}.\n$${#eq-output_leader_stack}\n\nFirm 2's output can be found using @eq-BR_stack:\n$$\nq_2^S = \\frac{a - c}{4b} = \\frac{q_1^S}{2}.\n$${#eq-output_follower_stack}\n    \n### Stackelberg vs Cournot\n\nIn Cournot games, both firms produce the same output that is _less_ than that of the Stackelberg's leader but _more_ than that of the Stackelberg's follower:\n$$\nq^S_{\\text{follower}} < q^C < q^S_{\\text{leader}}.\n$$\n\nThe equilibrium price can be computed using the demand function:\n$$\np^S = a - b(q^S_{\\text{follower}} + q^S_{\\text{leader}}) = \\frac{3a + c}{4},\n$${#eq-price_stack}\nwhich is greater than the Cournot price $p^C=\\frac{a+2c}{3}$ since $a>c.$\n\nProfits:\n$$\n\\pi_{\\text{leader}} = q^S_1(p^S - c) = \\frac{3(a-c)^2}{8b}.\n$${#eq-profit_leader_stack}\n\n$$\n\\pi_{\\text{follower}} = q^S_2(p^S - c) = \\frac{3(a-c)^2}{16b}.\n$${#eq-profit_follower_stack}\n\nHence the leader earns higher profits than in the Cournot case thanks to the first mover's advantage, but the follower earns lower profits.\n\nTo sum up:\n\n$$\n\\begin{aligned}\n&p^S > p^C, \\\\\n&q^S_{\\text{follower}} < q^C < q^S_{\\text{leader}}, \\\\\n&\\pi_{\\text{follower}} < \\pi^C < \\pi_{\\text{leader}}.\n\\end{aligned}\n$$\n    \n<!-- add a table here -->\n\n\n\n# Exercises\n\n::: {#exr-RPS}\nRock-Paper-Scissors is another simultaneous moves game. It can be played among multiple players; @fig-rockPaperS illustrates such a game between two. If two players make the same move, it is a draw. Otherwise rock beats scissors, which beats paper, which in turn beats rock. Find the best response of each player and determine if the game has a pure strategy NE. How about a mixed strategy NE?\n\n::: {#fig-rockPaperS fig-cap=\"Rock Paper Scissors game between two players\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=3 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Rock</td>\n        <td>Paper</td>\n        <td>Scissors</td>\n    </tr>\n    <tr>\n        <th rowspan=3>Player B</th>\n        <td>Rock</td>\n        <td style=\"text-align:center\">(0,0)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n    </tr>\n    <tr>\n        <td>Paper</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n    </tr>\n    <tr>\n        <td>Scissors</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exr-cournot}\nConsider two firms competing à la Cournot facing the same linear demand function $p(q_1,q_2)=a-b(q_1+q_2)$ but with asymmetric costs $C_i(q_i) = c_i q_i$ for $c_i > 0$ and $c_i\\neq c_j$, $i,j=\\{1, 2\\}$. Determine the NE of the Cournot game, the market price as well as the profits earned by each firm in equilibrium.\n:::\n\n::: {#exr-cournotNfirms}\nConsider again the Cournot model with identical linear costs and linear demand function. Determine the NE in the general case of $N$ firms. How do the equilibrium quantity, price and profits change as a function of $N?$ What happens as $N$ tends to infinity?\n:::\n\n::: {#exr-complPricing }\nThis exercise on complementary pricing is adapted from exercise 11 of chapter 13 of the AF Int textbook. Consider a situation where two firms of complementary goods simultaneously decide on how to price their goods. Suppose that there are only two actions possible: High or Low. The normal-form representation is presented here where the payoffs (in dollars) denote the profits for each firm:\n\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Firm 2</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>High</td>\n        <td>Low</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Firm 1</th>\n        <td>High</td>\n        <td style=\"text-align:center\">(90,75)</td>\n        <td style=\"text-align:center\">(35,40)</td>\n    </tr>\n    <tr>\n        <td>Low</td>\n        <td style=\"text-align:center\">(45,30)</td>\n        <td style=\"text-align:center\">(60,60)</td>\n    </tr>\n</table>\n\n1. Find all pure-strategy Nash equilibria of this game. \n\n2. Suppose now that one firm sets their price first, and then the other observes and responds. Depict the extensive form of this game and find the SPE. You should consider two cases each of which corresponds to a different first mover.\n \n3. Compare the results from the previous parts. Comment on the similarities and/or differences.\n:::\n\n::: {#exr-SPE-with-info}\nFind the SPE of the following game with imperfect information. The dashed box means that the player in question faces an information set when called to make a move. In this example, if P1 makes the R move, she will not be able to observe P2's move when it is her turn to move again. In other words, she does not know whether she is on the C or the D branch.\n\n```{mermaid}\ngraph LR\n    %% left branch\n    player1{P1} -- L --> player2L{P2}\n    player2L -- A --> player1LL{P1}\n    player2L -- B --> player1LR{P1}\n    player1LL -- U --> au(\"(1,4)\")\n    player1LL -- V --> av(\"(4,5)\")\n    player1LR -- W --> bw(\"(7,2)\")\n    player1LR -- X --> bx(\"(3,8)\")\n\n    player1 -- R --> player2R{P2}\n    player2R -- C --> player1RL{P1}\n    player2R -- D --> player1RR{P1}\n    player1RL -- Y --> cy(\"(7,2)\")\n    player1RL -- Z --> cz(\"(8,1)\")\n    player1RR -- Y --> dy(\"(6,3)\")\n    player1RR -- Z --> dz(\"(5,7)\")\n        \n    style player1RL stroke-dasharray: 4 4\n    style player1RR stroke-dasharray: 4 4\n\n```\n\n:::","srcMarkdownNoYaml":"\n\n```{python}\n%load_ext autoreload\n%autoreload 2\n```\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport seaborn as sns\nimport pandas as pd\nimport dataframe_image as dfi\nimport ipywidgets as widgets\n# from IPython.display import display\n# from ipywidgets import interact\nimport pandas as pd\n```\n\n```{python}\nimport sys\nimport os\nmod_dir = os.path.join(os.getcwd(), 'modules')\nif mod_dir not in sys.path:\n    sys.path.append(mod_dir)\n\nimport micro_modules as mm\nmm.load_viz_settings()\n```\n\n```{python}\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n```\n\n# A word on organization \n\nThis chapter contains a lot of definitions and concepts specific to game theory. In order to help quickly locate and link these concepts together, I have decided to put them all in @sec-concepts. Whenever you encounter a new concept throughout the chapter, you will most likely find its definition there. \n\n# Game theory basics\n\n## Game building blocks and examples\n\nIn order to define a game, we typically need at least four elements:\n\n* **Players**: who are playing the game (at least two)\n* **Rules**: what are the rules of the game, what _moves_ are possible and what are prohibited\n* **Outcomes**: what are the possible results of the games (score combinations leading to a win or a loss, scenario(s) of a draw, etc.)\n* **Payoffs**: the players' preferences over outcomes\n\nThe objective of each player in a game is to identify strategies that maximize potential payoffs, given what they know about the rules of the game, their opponents, the possible outcomes and their preferences. A __strategy__ is a complete contingent plan telling a player what action to take in every possible situation of the game.\n\nLet us illustrate these elements via a couple of examples.\n\n::: {#exm-matchingPennies}\n## Matching pennies\n\n* Players: There are two players A and B\n* Rules: Each player puts down a coin, either heads or tails up\n* Outcomes: Player A wins if the coins match (both heads or tails). Player B wins if the coins do not match.\n:::\n\n\n::: {#exm-tennis}\n\n## Tennis\n\nLet us consider a tennis game in a single tennis tournament (there are doubles and mixed doubles, too). A tennis match typically consists of up to seven sets, each of which consists of several games. We will be considering a single tennis game.\n\n* Players: two players of the same sex\n* Rules:\n  \n  * Scoring: A game is scored as 15, 30, 40 and game. If both players reach 40, it's called \"deuce.\" To win from deuce, a player must win two consecutive points (advantage and game).\n  * Service: One player serves in each game. The server must hit the ball diagonally into the opponent's service box. A serve that touches the net but lands in the correct box is a \"let\" and is replayed. A serve is a fault if it lands outside the service box or if the server misses the ball. Two consecutive faults result in a double fault, giving the point to the opponent.\n  * Rallies: After the serve, players rally by hitting the ball back and forth. The ball must be hit before it bounces twice on the player's side.\n  * Winning Points: A point is won if the opponent fails to return the ball within the court boundaries, hits it into the net, or touches the net after hitting the ball before the ball lands on the other side of the court, etc.\n* Results: A single winner by means of the scoring rule (no ties).\n:::\n\n## Assumption of common knowledge of rationality\n\nIn all games studied, we assume that players are rational. Each player knows every element of the game, namely, the players involved, the strategy in each contingency and the resulting payoff in each situation. In addition, every player knows that the other player(s) know all of this, including the fact that this player knows that they know. \n\n# Graphical representation of games\n\nThere are two ways to represent a game: by means of a matrix (normal form) or a game tree (extensive form). \n\n## Normal form\n\nThe normal form is the representation of a game using a matrix whose columns and rows represent all possible outcomes. It is best used to represent games of simultaneous moves where order of play is not important. \n\n### Pure strategy Nash equilibrium\n\nIn the examples that follow, the first number represents the payoff to the player whose strategies show up on each row of the matrix. The second number reprsents the payoff to the player whose strategies show up on each column.Let us try to determine the best responses and the Nash equilibrium  of each game. The NE that consists of a strategies that each player chooses with certainty is called __a pure strategy NE__. We will see that not all games have a pure strategy NE but if we allow players to choose certain strategies probablistically (as is often the case in sports), then a NE generally exists. This type of NE is called a __mixed strategy NE__.\n\n::: {#exm-pennies}\n::: {#fig-pmatch fig-cap=\"Normal form representation of the game of matching pennies. If pennies matched B pays A one dollar, otherwise A pays B one dollar.\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Heads</td>\n        <td>Tails</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Player B</th>\n        <td>Heads</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n    </tr>\n    <tr>\n        <td>Tails</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-crops}\nConsider this example from [CoreEcon](https://core-econ.org/the-economy/microeconomics/04-strategic-interactions-02-game-theory.html) which describes a strategic situation between two farmers who decide on which crop to grow. If both grow the same crop, they will flood the market with the same good and pushing down the price. The land of the person named Anil is equally suitable for both types of crops (cassava and rice). For the other person, Bala, the land is as good as that of Anil for growing rice, but less so for cassava. The outcome of this situation can be predicted using a simple game theory setupt.\n\n::: {#fig-crop fig-cap=\"An agricultural game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Bala</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Rice</td>\n        <td>Cassava</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Anil</th>\n        <td>Rice</td>\n        <td style=\"text-align:center\">(4,4)</td>\n        <td style=\"text-align:center\">(6,3)</td>\n    </tr>\n    <tr>\n        <td>Cassava</td>\n        <td style=\"text-align:center\">(6,6)</td>\n        <td style=\"text-align:center\">(5,2)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-auto}\nConsider a automobile market serviced by two firms, Ford and BMW. If both innovate (for example, introducing new EV models, incorporating AI, etc.), then they will share the market as before but earn lower profits due to the high R&D costs. If one innovates and the other does not, then the market share gained from the former will more than compensate for the high costs and it generates higher profits as a result. If both do not innovate, they continue to earn high profits.\n\n::: {#fig-duopoly fig-cap=\"A prisoners' dilemma game of innovation\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Vueling</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Innovate</td>\n        <td>Do not innovate</td>\n    </tr>\n    <tr>\n        <th rowspan=2>EasyJet</th>\n        <td>Innovate</td>\n        <td style=\"text-align:center\">(5,5)</td>\n        <td style=\"text-align:center\">(10,2)</td>\n    </tr>\n    <tr>\n        <td>Do not innovate</td>\n        <td style=\"text-align:center\">(2,10)</td>\n        <td style=\"text-align:center\">(7,7)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exm-dating}\nGame theory is very much alive in dating. In the simplest scenario, imagine two individuals (the _players_) deciding how much effort to put into the relationship. If both slack off, they split quickly and move on with no damage done. If one is committed while the other is lukewarm, the one committed ends up paying a higher price and potentially feeling resentful after the split. If both are committed (exerting high efforts), the relationship blossoms and they live happily ever after.[^1]\n\n[^1]: This is not the only dating theory so please don't get too carried away.\n\n::: {#fig-dating fig-cap=\"A dating game with multiple Nash equilibria\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Lover A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Commit</td>\n        <td>Slack off</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Lover B</th>\n        <td>Commit</td>\n        <td style=\"text-align:center\">(7,7)</td>\n        <td style=\"text-align:center\">(-2,5)</td>\n    </tr>\n    <tr>\n        <td>Slack off</td>\n        <td style=\"text-align:center\">(5,-2)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n    </tr>\n</table>\n:::\n:::\n\nWhat are the differences in the outcomes of these games? Observe that the game of matching pennies in @exm-pennies does not have an equilibrium. There is always an incentive to deviate from a chosen strategy depending on the choice of the opponent. In @exm-crops, we have a unique Nash equilibrium that is also Pareto optimal.[^2] In @exm-auto, we have a unique Nash equilibrium which is not Pareto optimal: the pursuit of individual interest does not lead to a socially optimal outcome. This is an example of the famous Prisoners' Dilemma game. In @exm-dating, we see a situation of non-uniqueness of equilibria. \n\n[^2]: An allocation is called Pareto optimal if there exists no other feasible allocations that strictly improve the payoff of at least one individual without sacrificing the payoff of another.\n\n### Mixed strategy Nash equilibrium\n\nLet us return to @exm-pennies to illustrate mixed strategy NE. Suppose that B chooses H with probability $p$ and T with probability $1-p,$ and A chooses H with probability $q$ and T with probability $1-q.$ The modified pennies matching game can be rerpresented as in @fig-penniesMixedStrategy.\n\n::: {#fig-penniesMixedStrategy fig-cap=\"A mixed strategy matching pennies game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <td>$q$</td>\n        <td>$1-q$</td>        \n    </tr>\n    <tr>\n        <th></th>\n        <th></th>\n        <th></th>\n        <td>Heads</td>\n        <td>Tails</td>        \n    </tr>\n    <tr>\n        <th rowspan=2 style=\"text-align:center\">Player B</th>\n        <td>$p$</td>\n        <td>Heads</td>\n        <td>(-1,1)</td>\n        <td>(1,-1)</td>        \n    </tr>\n    <tr>\n        <td>$1-p$</td>\n        <td>Tails</td>\n        <td>(1,-1)</td>\n        <td>(-1,1)</td>        \n    </tr>\n</table>\n:::\n\nFor each player, one strategy is preferred to the other iff it generates a higher _expected payoff_. For A, the expected payoff from playing Heads is:\n\n$$\n    \\mathbb{E}^A_H[X] = p \\times 1 + (1 - p) \\times (-1) = 2p - 1.\n$$\n\nAnd from playing Tails is:\n\n$$\n    \\mathbb{E}^A_T[X] = p \\times (-1) + (1 - p) \\times 1 = 1 - 2p.\n$$\n\nHence A strictly prefers Heads to Tails if and only if\n\n$$\n\\mathbb{E}^A_H[X] \\gt \\mathbb{E}^A_T[X] \\iff p > \\frac{1}{2}.\n$$\n\nHence the best response of $A$ could be written as:\n$$\nq(p) = \\begin{cases}\n    1 & p > 0.5 \\\\\n    \\in [0,1] & p = 0.5 \\\\\n    0 & p < 0.5.\n\\end{cases}\n$${#eq-BRA-ms}\n\nLikewise for B:\n\n$$\n\\begin{aligned}\n\\mathbb{E}^B_H[X] &\\gt \\mathbb{E}^B_T[X] \\\\\n1 - 2q &\\gt 2q - 1 \\\\\nq &< \\frac{1}{2}\n\\end{aligned}\n$$\n\nThe best response of $B$ is thus:\n\n$$\np(q) = \\begin{cases}\n    1 & q < 0.5 \\\\\n    \\in [0,1] & q = 0.5 \\\\\n    0 & q > 0.5\n\\end{cases}\n$${#eq-BRB-ms}\n\nThe msNE is at the intersection of the two best response curves (red dot in @fig-msNE), which is when both probabilities are equal to one-half:\n\n$$\n    \\mathrm{msNE}(q, p) = (0.5, 0.5).\n$${#eq-msNE-pennies}\n\n::: {#fig-msNE fig-cap=\"Best response functions and msNE in the pennies matching game\"}\n```{python}\nq = np.linspace(0, 1.5, 50)\n# BR of B\nplt.hlines(y=1, xmin=0, xmax=0.5, lw=2, color='k')\nplt.vlines(x=0.5, ymin=0, ymax=1, lw=2, color='k')\nplt.hlines(y=0, xmin=0.5, xmax=1, lw=2, color='k', label='BR of B: $p(q)$')\n\n# BR of A\nplt.vlines(x=0, ymin=0, ymax=0.5, lw=2)\nplt.hlines(y=0.5, xmin=0, xmax=1, lw=2)\nplt.vlines(x=1, ymin=0.5, ymax=1, lw=2, label='BR of A: $q(p)$')\n\n# msNE\nplt.scatter(.5, .5, color='r', s=75, label='msNE')\n\nplt.ylabel('$p$ (Probability of B playing H)', loc='top')\nplt.xlabel('$q$ (Probability of A playing H)', loc='right')\nplt.xlim([-.1, 1.5])\nplt.ylim([-.1, 1.5])\nplt.xticks(np.linspace(0, 1, 5))\nplt.yticks(np.linspace(0, 1, 5))\nplt.legend(loc='best')\nplt.grid(None)\nplt.show()\n```\n:::\n\nIf A and B are complete strangers then it is safe to assume that both play each strategy with the same probability (i.e., completely random). In this case, each player _randomizes_ and we have a mixed strategy Nash equilibrium (msNE). \nAfter a few rounds, they might know each other better and are able to _update_ the values of $q$ and $p$ accordingly and the game might end up with a pure strategy NE.\nIn highly competitive sports, sometimes many strong players lose to completely unknown ones, why might it be the case? One explanation is data availability. Matches of highly ranked players receive much wider media coverage. Their style of play, strengths and weaknesses are analyzed to excruciating details by experts, including the opponents and their coaches. Consequently, we have a player that is almost completely exposed while the other remains a wild card. The lack of information plays to the advantage of the relatively unknown player, typically causing difficulties to the opponent in the first few rallies or encounters. But if there is anything remarkable about top athletes, it is their ability to adapt, i.e., to _update_ their knowledge about the opponent's style and counterstrike effectively. The advantage due to initial ignorance wears out pretty rapidly if the unknown player does not have real strengths.\n\n\n## Extensive form \n\nThe extensive form of the game records not just the outcomes but also the dynamic of the game. For this reason, it is often used to represent sequential games in which the order of play is important. Indeed, taking out the game dynamic and collapsing it into a matrix typically results in too many equilibria, as we see in @fig-normFormExtGame. In particular, the normal form representation provies two equilibria: (In, Accommodate) and (Out, Price War). Nevertheless, if we examine the game in extensive form using backward induction (starting from the end nodes), it is clear that the best response of the incumbent (P2) to the entrant's \"In\" is to accommodate. Knowing this, the incumbent would choose to go in. Hence the only equilibrium of the game would be (In, Accommodate). The equilibrium (Out, Price War) is described as _sequentially irrational_ because it is not a NE in the subgame starting from the decision node of the incumbent. In dynamic games, we would like to rule out such irrational equilibria, hence the need for the more refined solution concept of __subgame-perfect equilibrium__(@def-SPE).\n\n::: {#fig-extForm fig-cap=\"An extensive form game with two players, P1 (entrant) and P2 (incumbent). The entrant moves first.\"}\n```{mermaid}\nflowchart LR\n   entrant{P1} --> |In| incumbent{P2} \n   entrant -- Out --> A(\"(0,10)\")\n   incumbent -- Accommodate --> B(\"(5,5)\")\n   incumbent -- Price war --> C(\"(-2,-2)\")\n\n   linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n   linkStyle 2 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-normFormExtGame fig-cap=\"Normal form representation of a sequential moves game\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Potential entrant</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>In</td>\n        <td>Out</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Incumbent</th>\n        <td>Accommodate</td>\n        <td style=\"text-align:center\">(5,5)</td>\n        <td style=\"text-align:center\">(10,0)</td>\n    </tr>\n    <tr>\n        <td>Price war</td>\n        <td style=\"text-align:center\">(-2,-2)</td>\n        <td style=\"text-align:center\">(10,0)</td>\n    </tr>\n</table>\n:::\n\n## Backward induction and SPE\n\nIt is important to know how to identify and write an SPE. We solve for SPE using backward induction:\n\n  1. Start for the farthest end of the tree, focus on the decision point(s) of the last mover (the smallest subgames)\n  2. Identify her BR and shade the branch associated with her BR (i.e., the NE associated with each of these subgames)\n  3. Consider the second-to-last mover, identify her BR to the BR of the last mover, then shade this branch (another NE identified)\n  4. Repeat the previous step until we reach the first mover at the root node (the largest subgame is the entire game itself)\n\nThen we need to express the SPE as a strategy profile, which specifies the strategy for each player for every possible decision node where that player could be called to move, _even for nodes that are not reached_ in equilibrium.\n\n::: {#exm-SPE}\nConsider the following dynamic game with the first mover being Player 1 (P1). We would like to identify the SPE. For convenience I have put all the decision nodes in the diamond boxes.\n\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n    secondL -- A --> firstL{P1}\n    firstL -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    %% lower branch\n    first -- R --> secondR{P2}\n    secondR -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> firstR{P1}\n    firstR -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n```\n\nObserve that there are 5 subgames including the entire game itself. Let us use backward induction to solve for the NE in every subgame.\n\n::: {#fig-sgall fig-cap=\"Subgames\"}\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n\n    subgraph SG3\n        secondL -- A --> firstL{P1}\n        subgraph SG1\n            firstL -- V --> out2(\"(1,6)\")\n            firstL -- W --> out3(\"(4,5)\")\n            firstL -- X --> out4(\"(5,2)\")\n        end\n        secondL -- B --> out1(\"(7,1)\")\n        %% lower branch\n    end\n    \n    first -- R --> secondR{P2}\n    \n    subgraph SG4\n        secondR -- C --> out5(\"(2,7)\")\n        secondR -- D --> out6(\"(3,4)\")\n        secondR -- E --> firstR{P1}\n        subgraph SG2\n            firstR -- Y --> out7(\"(6,8)\")\n            firstR -- Z --> out8(\"(8,3)\")\n        end\n    end\n\n    style SG1 stroke:#0072c7,stroke-width:2px\n    style SG2 stroke:#4fe1d6,stroke-width:2px\n    style SG3 stroke:#db63d6,stroke-width:2px\n```\n:::\n\nWe now look for the NE in each subgame.\n\n::: {#fig-sg1 fig-cap=\"First subgame (SG1)\"}\n```{mermaid}\nflowchart LR\n    firstL{P1} -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    linkStyle 2 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg2 fig-cap=\"Second subgame (SG2)\"}\n```{mermaid}\nflowchart LR\n    firstR{P1} -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n    linkStyle 1 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg3 fig-cap=\"Third subgame (SG3)\"}\n```{mermaid}\nflowchart LR\n    secondL{P2} -- A --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg4 fig-cap=\"Fourth subgame (SG4)\"}\n```{mermaid}\nflowchart LR\n    secondR{P2} -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> out8(\"(8,3)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\n::: {#fig-sg5 fig-cap=\"Fifth subgame (root node)\"}\n```{mermaid}\nflowchart LR\n    first{P1} -- L --> out4(\"(5,2)\") \n    first -- R --> out5(\"(2,7)\")\n    linkStyle 0 stroke:#111,stroke-width:4px,color:#000\n```\n:::\n\nFinally putting it all together, we can write the SPE as:\n$$\nSPE = \\{(L,\\: A/C, \\: X/Z\\}.\n$${#eq-SPE}\nRecall that we have to specify the strategy for each player for every possible decision node where that player could be called to move, _even for nodes that are not reached_ in equilibrium.\n\n```{mermaid}\nflowchart LR\n    %% upper branch\n    first{P1} -- L --> secondL{P2} \n    secondL -- A --> firstL{P1}\n    firstL -- V --> out2(\"(1,6)\")\n    firstL -- W --> out3(\"(4,5)\")\n    firstL -- X --> out4(\"(5,2)\")\n    secondL -- B --> out1(\"(7,1)\")\n    %% lower branch\n    first -- R --> secondR{P2}\n    secondR -- C --> out5(\"(2,7)\")\n    secondR -- D --> out6(\"(3,4)\")\n    secondR -- E --> firstR{P1}\n    firstR -- Y --> out7(\"(6,8)\")\n    firstR -- Z --> out8(\"(8,3)\")\n    linkStyle 0 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 4 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 7 stroke:#db63d6,stroke-width:4px,color:#000\n    linkStyle 11 stroke:#0072c7,stroke-width:4px,color:#000\n    linkStyle 1 stroke:#db63d6,stroke-width:4px,color:#000\n```\n:::\n\n\n# Key game concepts {#sec-concepts}\n\n::: {#def-strategy}\n## Strategy\nA strategy is a complete contingent plan specifying which action a player selects in every possible situation (contingency) she might face during a game.\n:::\n\n::: {#exm-stratey}\nIn the pennies matching game in @exm-matchingPennies, each player has two possible strategies: heads (H) or tails (T). We can write\n$S_A=S_B=\\{H, T\\}.$\n:::\n\n::: {#def-strategyProfile}\n## Strategy profile\nA strategy profile is a list describing the strategies that _each_ player selects. In a game of $N$ players, a strategy profile is $s=(s_1,s_2,\\dots,s_N)$. Equivalently we often write $s=(s_i,s_{-i})$ for any $i=1,\\dots,N.$ Here $s_{-i}$ means the strategies selected by players other than $i.$\n:::\n\n::: {#exm-stratProf}\nIn the pennies matching game, there are four possible strategy profiles:\n$$\ns \\in \\{(H,T), (T,H), (T,T), (H,H)\\}.\n$$\nHence a strategy profile is an element in the product space $S_A\\times S_B,$ or more generally an element in $S_i\\times S_{-i}$ for any $i=1,\\dots,N.$\n:::\n\n\n::: {#def-payoff}\n## Payoff function\nThe payoff function of a player $i$ is a mapping from a strategy profile to a real number $u_i : S_i \\times S_{-i} \\to \\mathbb{R}.$\n:::\n\nObserve that the payoff of a player typically depends on the strategies selected by the others. This is the _strategic_ property of games.\n\n::: {#def-weakDom}\n## Strategic dominance\nStrategy $s_i$ is a weakly dominant strategy of player $i$ if\n$$\nu_i(s_i, s_{-i}) \\geq u_i(s_j, s_{-i}),\n$${#eq-weak-dom}\nfor every $s_i \\neq s_j$ and $s_{-i}$ selected by the other players.\nIf the inequality sign in condition [-@eq-weak-dom] is strict, then $s_i$ is called a strictly dominant strategy. If the inequality sign reverses direction, then player $i$ views $s_i$ as a weakly dominated strategy (strictly dominated if the inequality sign is strict.)\n:::\n\n::: {#def-bestResponse}\n## Best response\nThe strategy $s_i$ of player $i$ is called the best response to her opponents' strategy profile $s_{-i}$ if:\n$$\nu_i(s_i, s_{-i}) \\geq u_i(s_j, s_{-i}), \\quad\\forall j\\neq i.\n$${#eq-BRdef}\nWe often write:\n$$\ns_i \\in BR_i(s_{-i}). \n$${#eq-BRcorr}\n:::\n\n::: {#rem-BRcorr}\nIn general, for each strategy profile $s_{-i},$ the best response coming from $i$ needs not be unique, i.e., the best response is a correspondence. When $BR_i(s_{-i})$ is a singleton for every possible $s_{-i},$ we have a best response function.\n:::\n\n::: {#rem-BRvsSdom}\nObserve that a dominant strategy is a best response, but not conversely. In order for a best response to be a dominant strategy, condition [-@eq-BRdef] has to hold for _every possible_ strategy profile selected by the other players. In other words, whatever the strategies selected by the other player(s), the best response remains the same for player $i.$ Strategic dominance is thus a much stronger than best response.\n:::\n\n::: {#def-NashEqm}\n## Nash equilibrium\nA strategy profile $s^*=(s^*_i, s^*_{-i})$ is a Nash equilibrium if every player plays their best reponse given their opponnents' strategies, that is:\n$$\ns^*_i \\in BR_i(s^*_{-i}),\\quad \\forall i=1,...,N.\n$${#eq-NE}\n:::\n\n::: {#def-infoSet}\n## Information set\nIn the context of extensive form games, an information set faced by a player is a set that connects all the nodes that the player cannot distinguish.\n:::\n\n::: {#def-subgame}\n## Subgame\nA subgame is a portion of an extensive-form game that contains a decision node and all subsequent nodes following it.\nGraphically, if we draw a circle around a subgame, then this circle cannot cross any information set: every subgame must contain all its information sets. The presence of information sets thus reduces the number of subgames.\n:::\n\n::: {#def-SPE}\n## Subgame-perfect equilibrium\nA strategy profile $(s_i^*, s^*_{-i})$ is a SPE if it specifies a Nash equilibrium in each subgame.\n:::\n\n# Applications to imperfect competition\n\n## Cournot model\n\nThe Cournot model is a simultaneous-moves game in which firms compete on quantity. Consider an industry with two firms (i.e., a douopoly) selling a homogeneous product. Each firm $i$ independently and simultaneously determines output $q_i$ to maximize profits, $i=\\{1, 2\\}.$\nThey each face a linear total cost $C_i(q_i) = cq_i$, $c>0.$\nLinear inverse demand curve: $p(q_1, q_2) = a - b\\left(\\sum_{i=1}^N q_i\\right)$ where $a, b>0.$ Notice that the production choice of each firm affects the market price of the good and consquently the bottom line of the other firm. This would not have been the case in a perfectly competitive market.\n\nEach firm $i$ solves its profit maximization problem to determine the optimal production level:\n$$\n\\begin{aligned}\n\\max_{q_i} \\pi_i &= R_i(q_i) - C_i(q_i) \\\\\n&= p(q_1, q_2)q_i - cq_i \\\\\n&= [a - b(q_1 + q_2)]q_i - cq_i\n\\end{aligned}\n$${#eq-PMP_cournot}\n    \nThe FOC yields:\n$$\n\\frac{\\partial \\pi_i}{\\partial q_i} = 0 \\iff a - 2bq_i - bq_j = c.\n$${#eq-FOC_cournot}\n    \nFrom @eq-FOC_cournot we can derive the best response (BR) function, which specifies the optimal output of each firm given the output choice of the other firm:\n\n$$ \nq_i = BR_i(q_j) = \\frac{a - c}{2b} - \\frac{q_j}{2}, \\quad i\\neq j.\n$${#eq-BR_cournot}\n    \nThe two best response functions specify the Nash equiblirium of the the game.\n$$\n\\begin{cases}\nq_1 &=  \\frac{a - c}{2b} - \\frac{q_2}{2} \\\\\nq_2 &=  \\frac{a - c}{2b} - \\frac{q_1}{2}. \n\\end{cases}\n$$\n\nSolving this system, we obtain the NE of the Cournot game:\n$$\n(q_1^*, q_2^*) = \\left(\\frac{a-c}{3b}, \\frac{a-c}{3b}\\right).\n$${#eq-NE-cournot}\n\nLet us try and visualize this outcome.\n\n::: {#fig-cournot-game fig-cap=\"Cournot competition on quantity in a duopoly\"}\n\n```{python}\na, b, c = 6, .75, 2\nqmax = (a - c) / b\nqstar = (a - c) / (3 * b)\nqmid = (a - c) / (2 * b)\nq = np.linspace(0, 7, 100)\nqCournot = (a - c) / (3 * b)\ndef BR1(q):\n    return (a - c) / (2 * b) - 0.5 * q\ndef BR2(q):\n    return (a - c) / b - 2 * q\ndef eqline(q):\n    return q\nplt.plot(q, BR1(q), label='$BR_2(q_1)$', color='k', lw=2)\nplt.plot(q, BR2(q), label='$BR_1(q_2)$', color='C0', lw=2)\nplt.plot(q[:65], eqline(q[:65]), linestyle=\"--\", color='gray', label=\"$q_1=q_2$\")\nplt.vlines(x=0, ymin=qmax*0.99, ymax=q.max(), color='C0', lw=4)\nplt.hlines(y=0, xmin=qmax*0.99, xmax=q.max(), color='k', lw=4)\nplt.scatter(qstar, qstar, color='r', s=70, label=\"Cournot NE\")\n\n# annotations\nplt.vlines(x=qstar, ymin=0, ymax=qstar, linestyle='--', lw=.5, color='k')\nplt.hlines(y=qstar, xmin=0, xmax=qstar, linestyle='--', lw=.5, color='k')\nplt.text(qstar*0.85, -.5, \"$\\\\frac{a-c}{3b}$\", fontsize=12)\nplt.text(qmid*0.95, -.5, \"$\\\\frac{a-c}{2b}$\", fontsize=12)\nplt.text(qmax*0.95, -.5, \"$\\\\frac{a-c}{b}$\", fontsize=12)\nplt.text(-0.75, qstar*0.9, \"$\\\\frac{a-c}{3b}$\", fontsize=12)\nplt.text(-0.75, qmid*0.95, \"$\\\\frac{a-c}{2b}$\", fontsize=12)\nplt.text(-0.75, qmax, \"$\\\\frac{a-c}{b}$\", fontsize=12)\n\n\nplt.xlabel(\"$q_1$\", loc='right')\nplt.ylabel(\"$q_2$\", loc='top')\nplt.ylim([0, q.max()])\nplt.xlim([0, q.max()])\nplt.xticks([])\nplt.yticks([])\nplt.legend(loc='best')\nplt.show()\n```\n:::\n\nFor completeness let us compute the equilibrium price of the duopoly, aggregate output and the profits earned by each firm.\n\n* Total output:\n    $$ \n    Q^C = q_1 + q_2 = 2q^C = \\frac{2(a - c)}{3b}. \n    $${#eq-totQ_cournot}\n    \n* Equlibrium price via the market demand curve:\n    $$ \n    p^C = a - bQ^C = \\frac{a + 2c}{3}. \n    $${#eq-price_cournot}\n    \n* Identical individual profits equal to:\n    $$ \n    \\pi^C = p^C q^C - cq^C = \\frac{(a - c)^2}{9b}.\n    $${#eq-profit_cournot}\n    \n\n\n## Stackelberg model\n\nConsider 2 firms with the same constant marginal cost $c$ as in the Cournot case. They also compete on quantity, but _sequentially_.\nTHe structure of the game is the following:\n\n  * First, firm 1 chooses $q_1$\n  * Then, having observed the choice of firm 1, firm 2 chooses $q_2$\n    \nThe first mover advantage can be due to legal barriers. For example, if firm 1 invents a new drug, it typically has a patent that gives exclusive rights to produce and sell it during the lifetime of the patent (up to 20 years for certain drugs).\n\nWe solve this game by backward induction, starting from firm 2, the follower.\n\n### PMP of the follower\n\nThe PMP of the follower (Firm 2):\n$$\n\\max_{q_2} [a - b(q_1 + q_2)]q_2 - cq_2.\n$$\n\nFOC w.r.t $q_2$ yields the BR function for Firm 2:\n$$ \nq_2(q_1) \\equiv BR_2(q_1) = \\frac{a - c}{2b} - \\frac{q_1}{2}.\n$${#eq-BR_stack}\n\nObserve that @eq-BR_stack coincides with @eq-BR_cournot since in both cases Firm 2 treats $q_1$ as exogenous\n\n### PMP of the leader\n\nFirm 1 chooses its own output to maximize profits:\n$$\n\\max_{q_1} [a - b(q_1 + BR_2(q_1))]q_1 - cq_1.\n$${#eq-PMP_stack_leader}\n\nIn @eq-PMP_stack_leader, Firm 1 anticipates that Firm 2 will be maximizing her profits, i.e., settig $q_2 = BR_2(q_1)$.\n\nThe FOC w.r.t $q_1$ yields the BR function for Firm 1:\n$$ \n\\frac{a - c - 2bq_1}{2} = 0\n\\iff q_1^S = \\frac{a-c}{2b}.\n$${#eq-output_leader_stack}\n\nFirm 2's output can be found using @eq-BR_stack:\n$$\nq_2^S = \\frac{a - c}{4b} = \\frac{q_1^S}{2}.\n$${#eq-output_follower_stack}\n    \n### Stackelberg vs Cournot\n\nIn Cournot games, both firms produce the same output that is _less_ than that of the Stackelberg's leader but _more_ than that of the Stackelberg's follower:\n$$\nq^S_{\\text{follower}} < q^C < q^S_{\\text{leader}}.\n$$\n\nThe equilibrium price can be computed using the demand function:\n$$\np^S = a - b(q^S_{\\text{follower}} + q^S_{\\text{leader}}) = \\frac{3a + c}{4},\n$${#eq-price_stack}\nwhich is greater than the Cournot price $p^C=\\frac{a+2c}{3}$ since $a>c.$\n\nProfits:\n$$\n\\pi_{\\text{leader}} = q^S_1(p^S - c) = \\frac{3(a-c)^2}{8b}.\n$${#eq-profit_leader_stack}\n\n$$\n\\pi_{\\text{follower}} = q^S_2(p^S - c) = \\frac{3(a-c)^2}{16b}.\n$${#eq-profit_follower_stack}\n\nHence the leader earns higher profits than in the Cournot case thanks to the first mover's advantage, but the follower earns lower profits.\n\nTo sum up:\n\n$$\n\\begin{aligned}\n&p^S > p^C, \\\\\n&q^S_{\\text{follower}} < q^C < q^S_{\\text{leader}}, \\\\\n&\\pi_{\\text{follower}} < \\pi^C < \\pi_{\\text{leader}}.\n\\end{aligned}\n$$\n    \n<!-- add a table here -->\n\n\n\n# Exercises\n\n::: {#exr-RPS}\nRock-Paper-Scissors is another simultaneous moves game. It can be played among multiple players; @fig-rockPaperS illustrates such a game between two. If two players make the same move, it is a draw. Otherwise rock beats scissors, which beats paper, which in turn beats rock. Find the best response of each player and determine if the game has a pure strategy NE. How about a mixed strategy NE?\n\n::: {#fig-rockPaperS fig-cap=\"Rock Paper Scissors game between two players\"}\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=3 style=\"text-align:center\">Player A</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>Rock</td>\n        <td>Paper</td>\n        <td>Scissors</td>\n    </tr>\n    <tr>\n        <th rowspan=3>Player B</th>\n        <td>Rock</td>\n        <td style=\"text-align:center\">(0,0)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n    </tr>\n    <tr>\n        <td>Paper</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n    </tr>\n    <tr>\n        <td>Scissors</td>\n        <td style=\"text-align:center\">(-1,1)</td>\n        <td style=\"text-align:center\">(1,-1)</td>\n        <td style=\"text-align:center\">(0,0)</td>\n    </tr>\n</table>\n:::\n:::\n\n::: {#exr-cournot}\nConsider two firms competing à la Cournot facing the same linear demand function $p(q_1,q_2)=a-b(q_1+q_2)$ but with asymmetric costs $C_i(q_i) = c_i q_i$ for $c_i > 0$ and $c_i\\neq c_j$, $i,j=\\{1, 2\\}$. Determine the NE of the Cournot game, the market price as well as the profits earned by each firm in equilibrium.\n:::\n\n::: {#exr-cournotNfirms}\nConsider again the Cournot model with identical linear costs and linear demand function. Determine the NE in the general case of $N$ firms. How do the equilibrium quantity, price and profits change as a function of $N?$ What happens as $N$ tends to infinity?\n:::\n\n::: {#exr-complPricing }\nThis exercise on complementary pricing is adapted from exercise 11 of chapter 13 of the AF Int textbook. Consider a situation where two firms of complementary goods simultaneously decide on how to price their goods. Suppose that there are only two actions possible: High or Low. The normal-form representation is presented here where the payoffs (in dollars) denote the profits for each firm:\n\n<table style=\"width:80%\">\n    <tr>\n        <th></th>\n        <th></th>\n        <th colspan=2 style=\"text-align:center\">Firm 2</th>\n    </tr>\n    <tr style=\"text-align:center\">\n        <th></th>\n        <th></th>\n        <td>High</td>\n        <td>Low</td>\n    </tr>\n    <tr>\n        <th rowspan=2>Firm 1</th>\n        <td>High</td>\n        <td style=\"text-align:center\">(90,75)</td>\n        <td style=\"text-align:center\">(35,40)</td>\n    </tr>\n    <tr>\n        <td>Low</td>\n        <td style=\"text-align:center\">(45,30)</td>\n        <td style=\"text-align:center\">(60,60)</td>\n    </tr>\n</table>\n\n1. Find all pure-strategy Nash equilibria of this game. \n\n2. Suppose now that one firm sets their price first, and then the other observes and responds. Depict the extensive form of this game and find the SPE. You should consider two cases each of which corresponds to a different first mover.\n \n3. Compare the results from the previous parts. Comment on the similarities and/or differences.\n:::\n\n::: {#exr-SPE-with-info}\nFind the SPE of the following game with imperfect information. The dashed box means that the player in question faces an information set when called to make a move. In this example, if P1 makes the R move, she will not be able to observe P2's move when it is her turn to move again. In other words, she does not know whether she is on the C or the D branch.\n\n```{mermaid}\ngraph LR\n    %% left branch\n    player1{P1} -- L --> player2L{P2}\n    player2L -- A --> player1LL{P1}\n    player2L -- B --> player1LR{P1}\n    player1LL -- U --> au(\"(1,4)\")\n    player1LL -- V --> av(\"(4,5)\")\n    player1LR -- W --> bw(\"(7,2)\")\n    player1LR -- X --> bx(\"(3,8)\")\n\n    player1 -- R --> player2R{P2}\n    player2R -- C --> player1RL{P1}\n    player2R -- D --> player1RR{P1}\n    player1RL -- Y --> cy(\"(7,2)\")\n    player1RL -- Z --> cz(\"(8,1)\")\n    player1RR -- Y --> dy(\"(6,3)\")\n    player1RR -- Z --> dz(\"(5,7)\")\n        \n    style player1RL stroke-dasharray: 4 4\n    style player1RR stroke-dasharray: 4 4\n\n```\n\n:::"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"lecture_5.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.56","theme":{"light":"lux","dark":"darkly"},"mermaid":{"theme":"neutral"},"title":"Chapter 5. Game theory and imperfect competition","author":{"name":"My Dam","email":"my-thi-tra.dam@universite-paris-saclay.fr"},"toc-title":"Content","toc-location":"left"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}